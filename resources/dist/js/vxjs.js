"use strict";var Coord=function(e,t){this.x=+e?parseInt(e,10):0,this.y=+t?parseInt(t,10):0};Coord.prototype={add:function(e){return new Coord(this.x+(+e.x?parseInt(e.x,10):0),this.y+(+e.y?parseInt(e.y,10):0))},sub:function(e){return new Coord(this.x-(+e.x?parseInt(e.x,10):0),this.y-(+e.y?parseInt(e.y,10):0))},len:function(){return Math.sqrt(this.x*this.x+this.y*this.y)}};var Color=function(e){var t,n,r,o;if(!e)return this.r=0,this.g=0,this.b=0,void(this.a=1);/rgb\s*\(\s*\d{1,3}\s*,\s*\d{1,3}\s*,\s*\d{1,3}\s*(?:,\s(?:1|0)(?:\.\d+)?\s*)?\)/.test(e)?(t=+(e=e.slice(e.indexOf("(")+1,-1).split(","))[0],n=+e[1],r=+e[2],o=+e[3]):"#"===e.slice(0,1)&&(4===e.length?(t=parseInt(e.slice(1,2)+e.slice(1,2),16),n=parseInt(e.slice(2,3)+e.slice(2,3),16),r=parseInt(e.slice(3)+e.slice(3),16)):(t=parseInt(e.slice(1,3),16),n=parseInt(e.slice(3,5),16),r=parseInt(e.slice(5,7),16),o=parseInt(e.slice(7),16))),this.r=isNaN(t)||255<t?255:t,this.g=isNaN(n)||255<n?255:n,this.b=isNaN(r)||255<r?255:r,this.a=isNaN(o)||1<o?1:o};if(Color.prototype={toHex:function(){return"#"+("00"+Math.round(this.r).toString(16)).slice(-2)+("00"+Math.round(this.g).toString(16)).slice(-2)+("00"+Math.round(this.b).toString(16)).slice(-2)},toRGB:function(){return"rgb("+Math.round(this.r)+","+Math.round(this.g)+","+Math.round(this.b)+")"}},"function"!=typeof Function.prototype.bind&&(Function.prototype.bind=function(e){function t(){}function n(){return i.apply(this instanceof t?this:e,o.concat(r.call(arguments,0)))}var r=Array.prototype.slice,o=r.call(arguments,1),i=this;return t.prototype=i.prototype,n.prototype=new t,n}),Object.keys||(Object.keys=function(e){var t,n=[];for(t in e)e.hasOwnProperty(t)&&n.push(t);return n}),Object.create||(Object.create=function(e){if(1<arguments.length)throw new Error("Object.create polyfill allows only one parameter.");function t(){}return t.prototype=e,new t}),Array.isArray||(Array.isArray=function(e){return"[object Array]"==Object.prototype.toString.call(e)}),Array.prototype.forEach||(Array.prototype.forEach=function(e,t){for(var n=0,r=this.length;n<r;++n)n in this&&e.call(t,this[n],n,this)}),Array.prototype.map||(Array.prototype.map=function(e,t){for(var n=0,r=this.length,o=new Array(r);n<r;++n)n in this&&(o[n]=e.call(t,this[n],n,this));return o}),Array.prototype.filter||(Array.prototype.filter=function(e,t){for(var n,r=0,o=this.length,i=[];r<o;++r)r in this&&(n=this[r],e.call(t,n,r,this)&&i.push(n));return i}),Array.prototype.indexOf||(Array.prototype.indexOf=function(e,t){var n=this.length,r=+t||0;for(r=r<0?Math.ceil(r)+n:Math.floor(r);r<n;++r)if(r in this&&this[r]===e)return r;return-1}),String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s\s*/,"").replace(/\s+$/,"")}),Array.prototype.copy=function(){return this.slice(0)},Array.prototype.fill||(Array.prototype.fill=function(e){for(var t=Object(this),n=+t.length||0,r=+arguments[1]||0,o=void 0===arguments[2]?n:+o||0,i=r<0?Math.max(n+r,0):Math.min(r,n),a=0<o?Math.max(n+o,0):Math.min(o,n);i<a;)t[i++]=e;return t}),Array.prototype.swap=function(e,t){if(void 0===t&&(t=++e),!(e<0||e>=this.length||t<0||t>=this.length)){var n=this[e];this[e]=this[t],this[t]=n}},Array.prototype.inArray=function(e){return!(-1==this.indexOf(e))},Number.prototype.toFormattedString=function(e,t,n){var r,o="";if(t=t||".",n=n||",",e="number"==typeof e?Math.round(e):0,r=this.toFixed(e).toString().split("."),n){for(;3<r[0].length;)o=n+r[0].slice(-3)+o,r[0]=r[0].slice(0,-3);r[0]=r[0]+o}return(this<0?"-":"")+r[0]+(r[1]?t+r[1]:"")},String.prototype.lpad=function(e,t){for(var n=e-this.length,r="",o=t||" ";0<=--n;)r+=o;return r+this},String.prototype.rpad=function(e,t){for(var n=e-this.length,r="",o=t||" ";0<=--n;)r+=o;return this+r},String.prototype.shortenToLen=function(e){if(this.length<e)return String(this);var t=this.lastIndexOf(" ",e);return-1==t?this.slice(0,e):this.slice(0,t).replace(/\s+$/g,"")},String.prototype.toFloat=function(e){var t,n,r;return 2<(t=this.split(e||".")).length?NaN:t[1]&&!(n=parseInt(t[1],10))?NaN:(r=t[0].replace(/[^0-9]/g,""))?parseFloat(r+"."+n):NaN},String.prototype.toDateTime=function(e,t){var n,r,o,i,a,s,l,c,d,u=this.trim();switch(e=e||"date_de"){case"date_us":case"date_de":if(!(n=u.match(/^\d{1,2}([\/.\-])\d{1,2}\1\d{0,4}$/))&&/^([0-9]{4}|[0-9]{6}|[0-9]{8})$/.test(u))r=[u.slice(0,2),u.slice(2,4),u.slice(4)];else{if(!n||2!==n.length)return!1;if(3!==(r=u.split(n[1])).length)return!1}return o=[("00"+r[0]).slice(-2),("00"+r[1]).slice(-2),(""+(new Date).getFullYear()).slice(0,4-r[2].length)+r[2]],a="date_us"==e?(i=+o[1],+o[0]):(i=+o[0],+o[1]),s=+o[2],a<1||12<a?!1:!(i<1||i>new Date(s,a,0).getDate())&&(t?new Date(s,a-1,i):(n="date_de"==e?".":"/",o[0]+n+o[1]+n+o[2]));case"date_iso":if(!(n=u.match(/^\d{2}(\d{2})?([\/.\-])\d{1,2}\2\d{1,2}$/))&&/^([0-9]{6}|[0-9]{8})$/.test(u))r=[u.slice(0,2),u.slice(2,4),u.slice(4)];else{if(!n||3!==n.length)return!1;if(3!==(r=u.split(n[2])).length)return!1}return s=+(o=[(""+(new Date).getFullYear()).slice(0,4-r[0].length)+r[0],("00"+r[1]).slice(-2),("00"+r[2]).slice(-2)])[0],a=+o[1],i=+o[2],!(a<1||12<a)&&(!(i<1||i>new Date(s,a,0).getDate())&&(t?new Date(s,a-1,i):o[0]+"-"+o[1]+"-"+o[2]));case"time_hm":if(!(n=u.match(/^\d{1,2}([:.\-])\d{1,2}$/))&&/^[0-9]{4}$/.test(u))r=[u.slice(0,2),u.slice(2)];else{if(!n||2!==n.length)return!1;if(2!==(r=u.split(n[1])).length)return!1}return!(23<+r[0]||59<+r[1])&&("00"+r[0]).slice(-2)+":"+("00"+r[1]).slice(-2);case"time_hms":if(!(n=u.match(/^\d{1,2}([:.\-])\d{1,2}\1\d{1,2}$/))&&/^([0-9]{4}|[0-9]{6})$/.test(u))r=[u.slice(0,2),u.slice(2,4),u.slice(4)];else{if(!n||2!==n.length)return!1;if(3!==(r=u.split(n[1])).length)return!1}return l=+r[0],c=+r[1],d=+r[2],!(23<l||59<c||59<d)&&("00"+l).slice(-2)+":"+("00"+c).slice(-2)+":"+("00"+d).slice(-2)}},String.prototype.toUcFirst=function(){return this.slice(0,1).toUpperCase()+this.slice(1)},Date.prototype.format=function(e){var n=this,t={"%h":function(){return""+n.getHours()},"%H":function(){return(""+n.getHours()).lpad(2,"0")},"%i":function(){return""+n.getMinutes()},"%I":function(){return(""+n.getMinutes()).lpad(2,"0")},"%s":function(){return""+n.getSeconds()},"%S":function(){return(""+n.getSeconds()).lpad(2,"0")},"%d":function(){return""+n.getDate()},"%D":function(){return(""+n.getDate()).lpad(2,"0")},"%m":function(){return""+(n.getMonth()+1)},"%M":function(){return(""+(n.getMonth()+1)).lpad(2,"0")},"%y":function(){return(""+n.getFullYear()).slice(-2)},"%Y":function(){return""+n.getFullYear()},"%w":function(){return""+n.getCW()},"%W":function(){return(""+n.getCW()).lpad(2,"0")},"%z":function(){var e=n.getCW(),t=n.getMonth();return""+(1===e&&11===t?n.getFullYear()+1:52<=e&&!t?n.getFullYear()-1:n.getFullYear())},"%Z":function(){var e=n.getCW(),t=n.getMonth();return(""+(1===e&&11===t?n.getFullYear()+1:52<=e&&!t?n.getFullYear()-1:n.getFullYear())).lpad(2,"0")}};return e.replace(/%[hisdmywz]{1}/gi,function(e){return t[e]()})},Date.prototype.getAbsoluteDays=function(){return Math.floor(.1+this.getTime()/864e5)},Date.prototype.getCW=function(e){if(!e){var t=this.getDay()||7,n=this.getAbsoluteDays(),r=new Date(new Date(864e5*(n+4-t)).getFullYear(),0,-10);return Math.floor((n-t-r.getAbsoluteDays())/7)}var o=new Date(this.getFullYear(),0,1).getAbsoluteDays();if(0===new Date(this.getFullYear(),0,1).getDay())return Math.floor((this.getAbsoluteDays()-o)/7)+1},String.prototype.create=function(e){var t,n,r=document.createElement(this);if(this.attr){for(t=this.attr.length;t--;)if("name"===this.attr[t].name){try{r=document.createElement("<"+this+" name="+this.attr[t].value+">")}catch(e){}break}for(t=this.attr.length;t--;)"class"===(n=this.attr[t]).name?r.className=n.value:"type"===n.name?r.setAttribute(n.name,n.value):r[n.name]=n.value}return vxJS.dom.appendChildren(r,e)},String.prototype.setProp=function(e,t){var n,r=new String(this);if(r.attr||(r.attr=[]),1<arguments.length&&r.attr.push({name:e,value:t}),1===arguments.length)if(Array.isArray(e))for(n=e.length;n--;)r.attr.push({name:e[n][0],value:e[n][1]});else if("object"==typeof e)for(n in e)e.hasOwnProperty(n)&&r.attr.push({name:n,value:e[n]});return r},Array.prototype.create=function(e){var t,n=[];for(t=0;t<this.length;++t)n[t]=this[t].create(e);return n},Array.prototype.setProp=function(e,t){for(var n=this.length;n--;)this[n]=this[n].setProp(e,t);return this},Array.prototype.domWrapWithTag=function(e){var t,n,r="acronym|address|applet|area|a|base|basefont|big|blockquote|body|br|b|caption|center|cite|code|dd|dfn|dir|div|dl|dt|em|font|form|h1|h2|h3|h4|h5|h6|head|hr|html|img|input|i|kbd|link|li|map|menu|meta|ol|option|param|pre|p|q|samp|script|select|small|strike|strong|style|sub|sup|table|tbody|td|textarea|th|title|tr|tt|ul|u|var".split("|");if("string"==typeof e)for(t=0;t<this.length;++t)r.inArray(this[t])?this[t]=e.create(this[t].create()):this[t]=e.create(this[t]);else for(t=0;t<this.length;++t)for(n=0;n<e.length;++n)this[t]=e[n].create(this[t]);return this},function(){var e,t,n,r,o=["webkit","moz"],i=o.length,a=0;for(e=0;e<i&&!window.requestAnimationFrame;++e)t=o[e],window.requestAnimationFrame=window[t+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t+"CancelAnimationFrame"]||window[t+"CancelRequestAnimationFrame"];window.requestAnimationFrame&&window.cancelAnimationFrame||(window.requestAnimationFrame=function(e){return n=+new Date,r=Math.max(a+16,n),setTimeout(function(){e(a=r)},r-n)},window.cancelAnimationFrame=clearTimeout)}(),!this.vxJS)var vxJS={};!function(s){function i(e,t){var n=typeof e[t];return!!(x.isHM.test(n)&&e[t]||"unknown"==n)}function e(e,t){for(var n=t.length;n--;)if(!i(e,t[n]))return!1;return!0}function o(e){for(var t=[],n=e.length,r=0;r<n;)t.push(e[r++]);return t}var a,l,c,t,d,r,u,n,f,h,m,p,v,g,y,x={isHM:/^(object|function)$/i,isNumberOrString:/^(string|number)$/,blanks:/\s+/},b=s.document,S=b.documentElement,w="function"==typeof Object.assign?Object.assign:function(e,t){var n,r;if("object"!=typeof e)throw new TypeError("Cannot convert first argument to object");for(r=1;r<arguments.length;++r)if(null!=(t=arguments[r]))for(n in t=Object(arguments[r]))t.hasOwnProperty(n)&&(e[n]=t[n]);return e};if(!s.localStorage){var C=document.createElement("div"),J="localStorage";C.style.display="none",b.getElementsByTagName("head")[0].appendChild(C),C.addBehavior&&(C.addBehavior("#default#userdata"),C.load(J),s.localStorage={setItem:function(e,t){C.load(J),C.getAttribute(e)||++this.length,C.setAttribute(e,t),C.save(J)},getItem:function(e){return C.load(J),C.getAttribute(e)},removeItem:function(e){C.load(J),C.removeAttribute(e),C.save(J),this.length&&--this.length},clear:function(){var e,t=0;for(C.load(J);e=C.XMLDocument.documentElement.attributes[t++];)C.removeAttribute(e.name);C.save(J),this.length=0},key:function(e){return C.load(J),C.XMLDocument.documentElement.attributes[e]},length:C.XMLDocument.documentElement.attributes.length})}function N(o,i){var a=o.element||o;return t[i]||(t[i]=[]),t[i].inArray(a)||(t[i].push(a),"function"==typeof a["on"+i]&&c.push({id:0,elem:o,type:i,callback:a["on"+i],custom:!1}),a["on"+i]=function(e){var t,n,r=(e=e||s.event).target||e.srcElement||a;for(t=0,n=c.length;t<n;++t)c[t].elem===o&&c[t].type===e.type&&c[t].callback.apply(r,[e,o]);"mousewheel"==i&&vxJS.event.preventDefault(e)}),a["on"+i]}function T(e){for(var t=0,n=u.length;t<n;++t)u[t](e)}vxJS.element={register:function(e){var t=function(e){for(var t,n=a.length,r=e.nodeType&&1===e.nodeType?"element":"widget";n--;)if((t=a[n])[r]&&t[r]===e)return t}(e);return t||(t=new vxJS.E,e.element&&1===e.element.nodeType?(t.element=e.element,t.widget=e):e.nodeType&&1===e.nodeType&&(t.element=e),t.fxQueue=[],a.push(t)),t},registry:a=[]},vxJS.E=function(){},vxJS.E.prototype={addListener:function(e,t){return vxJS.event.addListener(this,e,t),this},removeListener:function(e){return vxJS.event.removeListener(this,e),this},fx:function(e,t){return vxJS.fx[e]&&vxJS.fx.add(this,e,t),this},pause:function(e){return vxJS.fx.pause(this,e),this},clearFxQueue:function(){return this.fxQueue=[],this},getActiveFx:function(){if(this.fxQueue&&this.fxQueue.length)return this.fxQueue[0]}},vxJS.event=(l=e(document,["createEvent","addEventListener","removeEventListener"])?"W3C":e(document,["fireEvent","attachEvent","detachEvent"])?"MS":"legacy",c=[],t={},d=0,r={},u=[],{fireEvent:function(e,t){switch(l){case"W3C":var n=document.createEvent("Event");return n.initEvent(t,!0,!0),void e.dispatchEvent(n);case"MS":return void e.fireEvent("on"+t,document.createEventObject());default:e["on"+t]()}},addDomReadyListener:(i(b,"addEventListener")?b.addEventListener("DOMContentLoaded",T,!1):i(s,"addEventListener")?s.addEventListener("load",T,!1):i(s,"attachEvent")?s.attachEvent("onload",T):("function"==typeof s.onload&&u.push(s.onload),s.onload=T),function(e){u.push(e)}),addXhrListener:function(e,t){var n="__ID__"+d++;return c.push({id:n,elem:"xhr",type:e,fn:null,callback:t,custom:!0}),n},addMousewheelListener:function(t,n){var e,r="__ID__"+d++,o="mousewheel";switch(l){case"W3C":e=function(e){n.apply(e.target,[e,t]),vxJS.event.preventDefault(e)},t.addEventListener(o,e,!1),t.addEventListener("DOMMouseScroll",e,!1),o=["mousewheel","DOMMouseScroll"];break;case"MS":t.attachEvent("onmousewheel",e=function(){n.apply(s.event.srcElement,[s.event,t]),vxJS.event.preventDefault(s.event)});break;default:e=N(t,"mousewheel")}return c.push({id:r,elem:t,type:o,fn:e,callback:n,custom:!1}),r},removeMousewheelListener:function(e,t){this.removeListener(e,"string"==typeof e||t?t:"mousewheel")},addListener:function(t,e,n){var r,o,i="__ID__"+d++,a=t.element;if(o=t.nodeType&&1===t.nodeType||t===b||t===window||a&&!this.isCustomEvent(a,e))switch(l){case"W3C":(a||t).addEventListener(e,r=function(e){n.apply(e.target,[e,t])},!1);break;case"MS":(a||t).attachEvent("on"+e,r=function(e){n.apply((e||s.event).srcElement,[e||s.event,t])});break;default:r=N(t,e)}else r=function(e){n.call(t,e)};return c.push({id:i,elem:t,type:e,fn:r,callback:n,custom:!o}),i},removeListener:function(e,t){var n,r;if("string"==typeof e)for(n=c.length;n--&&(r=c[n]).id!==e;);else if("string"==typeof t)for(e.element&&!this.isCustomEvent(e.element,t)&&(e=e.element),n=c.length;n--&&((r=c[n]).elem!==e||("string"!=typeof r||r.type!=t)&&-1==r.type.indexOf(t)););else for(n=c.length;n--&&(!((r=c[n]).elem===e||r.elem.element&&r.elem.element===e)||r.callback!==t););if(!(n<0||(c.splice(n,1),r.custom)))switch(l){case"W3C":"string"==typeof r.type?(r.elem.element||r.elem).removeEventListener(r.type,r.fn,!1):r.type.forEach(function(e){(r.elem.element||r.elem).removeEventListener(e,r.fn,!1)});break;case"MS":"string"==typeof r.type?(r.elem.element||r.elem).detachEvent("on"+r.type,r.fn):r.type.forEach(function(e){(r.elem.element||r.elem).detachEvent("on"+e,r.fn)}),delete r.fn}},serve:function(e,t,n){for(var r,o=0;r=c[o++];)r.elem===e&&r.type===t&&r.fn(n)},serveXhr:function(e,t){for(var n,r=0;n=c[r++];)"xhr"===n.elem&&n.type===t&&n.callback.apply(e)},isCustomEvent:function(e,t){var n;return n=(t="on"+t)+(e.tagName||""),void 0===r[n]&&(r[n]=!0,i(e,"setAttribute")&&void 0===e[t]&&(e.setAttribute(t,"return true;"),r[n]=i(e,t))),!r[n]},getAbsMousePos:function(e){return new Coord(e.clientX,e.clientY).add(vxJS.dom.getDocumentScroll())},getMouseButtons:function(e){var t=e.which;return void 0!==t?{left:1==t,right:2==t,middle:3==t}:{left:1&(t=e.button),right:2&t,middle:4&t}},getMousewheelDirection:function(e){return e.detail?e.detail<1?"up":"down":1<e.wheelDelta?"up":"down"},cancelBubbling:function(e){i(e,"stopPropagation")&&e.stopPropagation(),e.cancelBubble=!0},preventDefault:function(e){i(e,"preventDefault")&&e.preventDefault(),e.returnValue=!1}}),vxJS.dom={getBody:function(){return y=y||(b.body&&"object"==typeof b.body?b.body:b.getElementsByTagName("body")[0]||null)},unitToPixels:(p=document.createElement("div"),v=p.style,g={position:"absolute",border:"none",margin:"0",padding:"0",height:"1px",visibility:"hidden"},Object.keys(g).forEach(function(e){v[e]=g[e]}),function(e){var t,n=this.getBody();return v.width="10"+e,n.appendChild(p),t=p.offsetWidth/10,n.removeChild(p),t}),allowsFixedPosition:function(){if(void 0===m){var e,t="div".create(),n=t.style,r=vxJS.dom.getBody();n.position="fixed",n.top="0px",n.left="0px",r.appendChild(t),e=vxJS.dom.getElementOffset(t),r.removeChild(t),m=!e.x&&!e.y}return m},setOpacity:function(e,t){var n=e.style,r=1<t?1:t<0?0:t;"string"==typeof n.opacity?n.opacity=""+r:"string"==typeof n.filter&&(n.filter="alpha(opacity="+100*r+")")},getOpacity:function(e){var t,n=e.style;return"string"==typeof n.opacity?n.opacity?+n.opacity:1:e.filters&&void 0!==e.filters.Alpha.opacity?e.filters.Alpha.opacity/100:"string"==typeof n.filter&&(t=n.filter.match(/\s*opacity\s*=\s*(\d+)/i))&&t[1]?t[1]/100:1},getStyle:function(e,t){return s.getComputedStyle?s.getComputedStyle(e,"")[t]:!!e.currentStyle&&e.currentStyle[t]},hasClassName:function(e,t){return-1!==(" "+e.className+" ").indexOf(" "+t+" ")},addClassName:function(e,t){this.hasClassName(e,t)||(e.className+=(e.className.trim().length?" ":"")+t)},removeClassName:function(e,t){var n=e.className.split(x.blanks),r=n.indexOf(t);-1!==r&&(n.splice(r,1),e.className=n.join(" "))},appendChildren:function(e,t){var n;if(x.isNumberOrString.test(typeof t))e.appendChild(document.createTextNode(t));else if(t)if(void 0!==t.length&&void 0===t.nodeName)for(n=0;n<t.length;++n)x.isNumberOrString.test(typeof t[n])?e.appendChild(document.createTextNode(t[n])):t[n]&&e.appendChild(t[n]);else e.appendChild(t);return e},deleteChildNodes:function(e){for(;e.hasChildNodes();)e.removeChild(e.lastChild)},cleanDOM:(h=/\S/,function e(t){var n;if(8===t.nodeType||3===t.nodeType&&!h.test(t.data))t.parentNode.removeChild(t);else if(t.childNodes)for(n=t.childNodes.length;n--;)e(t.childNodes[n])}),walk:function(e,t){for(t(e),e=e.firstChild;e;)this.walk(e,t),e=e.nextSibling},getElementsByClassName:(f={},i(document,"getElementsByClassName")?function(e,t,n){var r=(t||document).getElementsByClassName(e);return n?(n=n.toUpperCase(),Array.prototype.filter.call(r,function(e){return e.nodeName==n})):o(r)}:i(document,"evaluate")?function(e,t,n){var r,o,i=[],a=0;for(o=document.evaluate(".//"+(n||"*").toLowerCase()+"[contains(concat(' ', @class, ' '), ' "+e+" ')]",t||document,function(e){return"html"===e?"http://www.w3.org/1999/xhtml":null},XPathResult.UNORDERED_NODE_SNAPSHOT_TYPE,null);r=o.snapshotItem(a);)i[a++]=r;return i}:function(e,t,n){var r,o,i,a=[],s=0,l=(t||document).getElementsByTagName(n?n.toLowerCase():"*");for(f[e]?o=f[e]:(o=new RegExp("(^|\\s)"+e+"(\\s|$)"),f[e]=o);r=l[s++];)(i=r.className)&&(i==e||o.test(i))&&a.push(r);return a}),getParentElement:function(e,t){var n,r,o;if(!t)return e.parentNode;if(/^[a-z0-9]+$/i.test(t)){for(n=t.toUpperCase();e=e.parentNode;)if(e.nodeName.toUpperCase()===n)return e}else{if(!(r=t.match(/^([a-z0-9]+)([\.#])(\w+)$/i))||r.length<3)return null;for(n=r[1].toUpperCase(),o="."===r[2]?new RegExp("\\b"+r[3]+"\\b"):null;e=e.parentNode;)if(e.nodeName.toUpperCase()===n&&(!o&&e.id===r[3]||o.test(e.className)))return e}return null},getElementOffset:function(e,t){var n,r,o,i=e.ownerDocument,a=this.getBody();if(e===(t=t||i))return new Coord(0,0);for(o=function(e,t){var n=typeof e[t];return!(!x.isHM.test(n)||!e[t])}(e,"offsetParent")?e.offsetParent:null,r=e.parentNode,n=new Coord(e.offsetLeft,e.offsetTop);r&&r!==t;)r!==a&&r!==S&&(n.x-=r.scrollLeft||0,n.y-=r.scrollTop||0),r===o&&r!==a&&(n.x+=o.offsetLeft,n.y+=o.offsetTop,o=r.offsetParent),r=r.parentNode;return n},getElementPosition:function(e){return new Coord(parseInt(this.getStyle(e,"left"),10),parseInt(this.getStyle(e,"top"),10))},setElementPosition:function(e,t){var n=e.style;n.left=t.x+"px",n.top=t.y+"px"},getElementSize:function(e){return new Coord(e.offsetWidth,e.offsetHeight)},getElementStyleSize:function(e){var t=e.style,n=t.width,r=t.height,o=this.getElementSize(e),i=new Coord(o.x,o.y);return t.height=o.y+"px",i.y-=e.offsetHeight-o.y,t.height=r,t.width=o.x+"px",i.x-=e.offsetWidth-o.x,t.width=n,i},setElementSize:function(e,t){var n=e.style;n.width=t.x+"px",n.height=t.y+"px"},nextSameNodeNameSibling:function(e){for(var t=e.nodeName;e=e.nextSibling;)if(e.nodeName===t)return e},prevSameNodeNameSibling:function(e){for(var t=e.nodeName;e=e.previousSibling;)if(e.nodeName===t)return e},moveBefore:function(e,t){var n=e.parentNode;n.removeChild(e),n.insertBefore(e,t)},moveAfter:function(e,t){var n=e.parentNode;n.removeChild(e),n.insertBefore(e,t?t.nextSibling:null)},concatText:function(e){var t,n,r="",o=e.childNodes;for(t=0;t<o.length;t++)switch(o[t].nodeType){case 1:if("INPUT"===(e=o[t].nodeName.toUpperCase())&&"text"===o[t].type)r+=o[t].value;else{if("SELECT"===e&&"select-one"===o[t].type&&o[t].options&&0<=o[t].selectedIndex&&o[t].options[o[t].selectedIndex]){r+=this.concatText(o[t].options[o[t].selectedIndex]);break}if("SELECT"===e&&"select-multiple"===o[t].type&&o[t].options)for(n=o[t].options.length;n--;)r+=o[t].options[n].selected?this.concatText(o[t].options[n]):"";else r+="IMG"===e?o[t].title?o[t].title:o[t].alt?o[t].alt:o[t].src:this.concatText(o[t])}break;case 3:r+=o[t].nodeValue}return r},parse:function(e){var t,n,r=document.createDocumentFragment(),s=function(e,t){var n,r,o,i,a=e.properties;if(!e.node){if(e.text)return void t.appendChild(document.createTextNode(e.text));if(e.html){for((i=document.createElement("div")).innerHTML=e.html;i.firstChild;)t.appendChild(i.firstChild);return}return e.fragment?void t.appendChild(e.fragment):void 0}if(o=document.createElement(e.node),"object"==typeof a)for(n in a)a.hasOwnProperty(n)&&("text"===n?o.appendChild(document.createTextNode(a[n])):o[n]=a[n]);if(e.childnodes&&(r=e.childnodes.length))for(n=0;n<r;n++)s(e.childnodes[n],o);t.appendChild(o)};if(Array.isArray(e))for(t=0,n=e.length;t<n;++t)s(e[t],r);else s(e,r);return r},getViewportSize:function(){var i=this.getBody();if(n)return n();var r="string"==typeof b.compatMode?function(){return S&&-1!==b.compatMode.toLowerCase().indexOf("css")?S:i}:function(){return S&&0!==S.clientWidth?S:i};if(S)var o=function(){var e,t={compatMode:b.compatMode},n=S.clientHeight,r=i.clientHeight,o=b.createElement("div");if(o.style.height="100px",i.appendChild(o),t.body=!n||n!=S.clientHeight,t.html=r!=i.clientHeight,i.removeChild(o),t.body||t.html&&t.body!=t.html)return"number"==typeof i.clientTop&&i.clientTop&&S.clientWidth&&(e=i.style.borderWidth,i.style.borderWidth="0px",t.includeBordersInBody=i.clientHeight!=r,i.style.borderWidth=e),t}();return"number"==typeof b.clientWidth?n=function(){return new Coord(b.clientWidth,b.clientHeight)}:S&&"number"==typeof S.clientWidth?n=function(){var e,t,n=r();return o&&(n=o.body?i:S),e=n.clientHeight,t=n.clientWidth,o&&o.body&&o.includeBordersInBody&&(e+=2*i.clientTop,t+=2*i.clientLeft),new Coord(t,e)}:"number"==typeof window.innerWidth&&(n=function(){return new Coord(window.innerWidth,window.innerHeight)}),n?n():void 0},getDocumentScroll:function(){return"number"==typeof s.pageXOffset?this.getDocumentScroll=function(){return new Coord(s.pageXOffset,s.pageYOffset)}:this.getDocumentScroll=function(){return new Coord(Math.max(vxJS.dom.getBody().scrollLeft,S.scrollLeft),Math.max(vxJS.dom.getBody().scrollTop,S.scrollTop))},this.getDocumentScroll()}},vxJS.selection={getSelection:i(s,"getSelection")?function(){return s.getSelection()}:i(b,"selection")?function(){return b.selection}:void 0,set:function(e,t,n){var r;t=t||0,void 0===n&&(n=e.value.length-t),i(e,"setSelectionRange")?e.setSelectionRange(t,t+n):i(e,"createTextRange")&&((r=e.createTextRange()).moveStart("character",t),r.moveEnd("character",t+n-e.value.length),r.select()),e.focus()},get:function(e){var t,n;return void 0!==e.selectionStart?e.value.substring(e.selectionStart,e.selectionEnd):(n=this.getSelection())&&i(n,"createRange")?(t=n.createRange()).parentElement==e?t.text:void 0:""},getCaretPosition:function(e){var t,n,r,o;return void 0!==e.selectionStart?e.selectionStart:(t=this.getSelection())&&i(t,"createRange")?(e.focus(),n=t.createRange(),o=(r=e.createTextRange()).duplicate(),r.moveToBookmark(n.getBookmark()),o.setEndPoint("EndToStart",r),o.text.length):void 0},setCaretPosition:function(e,t){"end"===t?this.set(e,e.value.length):this.set(e,+t||0,0)}},vxJS.cookie={getItem:function(e){return decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))||null},setItem:function(e,t,n,r,o,i){var a="";if(!e||/^(?:expires|max\-age|path|domain|secure)$/i.test(e))return!1;if(n)switch(n.constructor){case Number:a=n===1/0?"; expires=Fri, 31 Dec 9999 23:59:59 GMT":"; max-age="+n;break;case String:a="; expires="+n;break;case Date:a="; expires="+n.toUTCString()}return document.cookie=encodeURIComponent(e)+"="+encodeURIComponent(t)+a+(o?"; domain="+o:"")+(r?"; path="+r:"")+(i?"; secure":""),!0},removeItem:function(e,t,n){return!(!e||!this.hasItem(e))&&(document.cookie=encodeURIComponent(e)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT"+(n?"; domain="+n:"")+(t?"; path="+t:""),!0)},hasItem:function(e){return new RegExp("(?:^|;\\s*)"+encodeURIComponent(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=").test(document.cookie)}},vxJS.isHostMethod=i,vxJS.hasHostMethods=e,vxJS.isEmpty=function(e){var t;if("object"!=typeof e)return!0;for(t in e)if(e.hasOwnProperty(t))return!1;return!0},vxJS.merge=w,vxJS.collectionToArray=o,vxJS.widget={}}(this),vxJS.xhrObj=function(){var e;try{e=new XMLHttpRequest}catch(e){}if(e)return function(){return new XMLHttpRequest};try{e=new ActiveXObject("Microsoft.XMLHTTP")}catch(e){}if(e)return function(){return new ActiveXObject("Microsoft.XMLHTTP")};throw Error("vxJS.xhr: Can't instantiate XMLHttpRequest!")}(),vxJS.xhr=function(o,i,a,s){i=i||{},a=a||{};function l(){a.node&&vxJS.dom.removeClassName(a.node,"active"),f&&window.clearTimeout(f),p&&(p.onreadystatechange=function(){},0!==p.readyState&&4!==p.readyState&&p.abort())}function c(){4===p.readyState&&(l(),200<=p.status&&p.status<300||1223===p.status?(o.forcePlainTextResponse?v.response=p.responseText:o.forceXMLResponse?v.response=p.responseXML||p.responseText:v.response=JSON.parse(p.responseText||"{}"),s&&"function"==typeof s.complete&&s.complete.call(v),vxJS.event.serve(v,"complete"),vxJS.event.serveXhr(v,"complete")):(s&&"function"==typeof s.fail&&s.fail.call(v),vxJS.event.serve(v,"fail"),vxJS.event.serveXhr(v,"fail")))}function d(e,t){m[e]=t}function u(e){var t,o,n=[],i=function(t,e){var n,r=[];if("function"==typeof e)return"";if(!0===e)return encodeURIComponent(t)+"=1";if(!1===e)return encodeURIComponent(t)+"=0";if(null===e)return encodeURIComponent(t)+"=";if(Array.isArray(e))return o=0,e.forEach(function(e){r.push(i(t+"["+o+++"]",e))}),r.join("&");if("object"!=typeof e)return encodeURIComponent(t)+"="+encodeURIComponent(e);for(n in e)e.hasOwnProperty(n)&&r.push(i(t+"["+n+"]",e[n]));return r.join("&")};for(t in e)e.hasOwnProperty(t)&&n.push(i(t,e[t]));return n.join("&")}var f,h=(o=o||{}).timeout||5e3,m={},p=vxJS.xhrObj(),v={response:{}};return v.setHeader=function(e,t){return d(e,t),this},v.use=function(e,t,n,r){return e&&(o=vxJS.merge(o,e)),t&&(i=t),n&&(a=n),r&&(s=r),this},v.getRequestParameters=function(){return o},v.getParameters=function(){return i},v.getAnimationParameters=function(){return a},v.getCallbacks=function(){return s},v.xhrObj=p,v.abort=l,v.submit=function(){var e,t,n=window.location,r=encodeURI(o.uri||(n.hash?n.href.substring(0,n.href.indexOf(n.hash)):n.href));if(l(),o.command&&(i.httpRequest=o.command),o.echo&&(i.echo=1),d("X-Requested-With","XMLHttpRequest"),o.forceXMLResponse&&p.overrideMimeType&&p.overrideMimeType("text/xml"),o.method&&"GET"==o.method.toUpperCase()){for(p.open("GET",r+=(-1!==r.indexOf("?")?"&":"?")+(new Date).getTime()+"&"+(o.useJsonSerialization?"xmlHttpRequest="+encodeURIComponent(JSON.stringify(i)):u(i)),!0),e=0,t=Object.keys(m);e<t.length;++e)p.setRequestHeader(t[e],m[t[e]]);p.onreadystatechange=c,vxJS.event.serve(v,"beforeSend"),p.send(null)}else if(p.open("POST",r,!0),o.upload){if(i.file){for(d("X-File-Name",i.filename||i.file.name),d("X-File-Size",i.file.size),d("X-File-Type",i.file.type),e=0,t=Object.keys(m);e<t.length;++e)p.setRequestHeader(t[e],m[t[e]]);p.onreadystatechange=c,vxJS.event.serve(v,"beforeSend"),p.send(i.file)}}else{for(d("Content-Type","application/x-www-form-urlencoded"),e=0,t=Object.keys(m);e<t.length;++e)p.setRequestHeader(t[e],m[t[e]]);p.onreadystatechange=c,vxJS.event.serve(v,"beforeSend"),o.useJsonSerialization?p.send("xmlHttpRequest="+encodeURIComponent(JSON.stringify(i))):p.send(u(i))}0<h&&(f=window.setTimeout(function(){l(),s&&"function"==typeof s.timeout&&s.timeout.call(v),vxJS.event.serve(v,"timeout"),vxJS.event.serveXhr(v,"timeout")},h)),a.node&&vxJS.dom.addClassName(a.node,"active")},v},vxJS.widget.xhrForm=function(c,o,h){if(!c.nodeName||"form"!=c.nodeName.toLowerCase())throw new Error("widget.xhrForm: no form element specified!");h=h||{};function d(){var e,t;if(S){switch(T||(k.style.display="block",T=vxJS.dom.getElementSize(k),k.style.display=""),e=vxJS.dom.getElementOffset(S),t=vxJS.dom.getElementSize(S),S.getAttribute("data-throbber-position")){case"outside-left":e.x-=T.x;break;case"inside-left":e.x+=T.x;break;case"inside-right":e.x+=t.x-T.x;break;default:e.x+=t.x}e.y+=(t.y-T.y)/2,vxJS.dom.setElementPosition(k,e)}}function u(){J=!0}function f(){J=!1}function i(){var t;if(C){try{t=JSON.parse((w.contentDocument||w.contentWindow.document).body.innerHTML)}catch(e){t={}}l&&(window.clearTimeout(l),A()),vxJS.dom.removeClassName(k,"active"),f(),vxJS.event.serve(M,"ifuResponse",t),O(t)}}function m(e){for(var t,n,r,o=e.length;o--;)if(r=c.elements[e[o].name])switch(t=e[o].value,r.type){case"radio":case"checkbox":r.checked=!!t;break;case"select-multiple":if(Array.isArray(t))for(n=r.options.length;n--;)r.options[n].selected=-1!==t.indexOf(r.options[n].value);break;default:r.value=t||""}}function p(){E.forEach(function(e){var t;e.elements.forEach(function(e){vxJS.dom.removeClassName(e,"error")}),(t=document.getElementById("error_"+e.name))&&(vxJS.dom.removeClassName(t,"error"),e.text&&t.lastChild&&t.removeChild(t.lastChild))}),E=[]}function n(e,t){var n,r,o,i,a,s,l,c,d,u={},f=/^(.*?)\[(.*?)\]$/;for(n=0;n<e.length;++n)if(l=r=null,s=(a=e[n]).name,h.namesToHashes&&(l=s.match(f))&&(s=l[1],c=l[2],r={}),a.type&&!a.disabled){switch(a.type){case"radio":case"checkbox":a.checked&&(c?r[c]=a.value:r=a.value);break;case"select-multiple":if(vxJS.dom.hasClassName(a,"vxJS_dualSelectBox_source"))continue;for(d=[],o=(i=a.options).length;o--;)(i[o].selected||vxJS.dom.hasClassName(a,"vxJS_dualSelectBox_dest"))&&d.push(i[o].value);c?r[c]=d:r=d;break;case"select-one":c?r[c]=a.options[a.selectedIndex].value:r=a.options[a.selectedIndex].value;break;case"submit":case"image":case"button":t&&a===t&&(r=a.value);break;default:l?r[c]=a.value:r=a.value}if(null===r||"object"==typeof r&&!Object.keys(r).length)continue;void 0===u[s]?u[s]=l?[r]:r:c?u[s][c]=r[c]:(Array.isArray(u[s])||(u[s]=[u[s]]),u[s].push(r))}return u}function v(e){for(var t=D.length;t--;)if(e===D[t].id)return D[t].container}function g(){var t;function n(){var e=this.response;!e||e.cancel_upload?(window.clearTimeout(l),vxJS.event.serve(M,"apcFinish"),A()):(vxJS.event.serve(M,"apcUpdate"),function(e){if(s||a){var t=e.total&&e.current?(e.current/e.total*100).toFixed():0;e.filename;s&&(s.firstChild.nodeValue=t+"%"),a&&(a.firstChild.style.width=t+"%")}}(e))}(s||a)&&(s&&(s.style.display=""),a&&(a.style.display="")),function e(){t?t.use():(t=vxJS.xhr({command:"apcPoll"},{id:y.value}),vxJS.event.addListener(t,"complete",n)),l=window.setTimeout(e,1e3)}()}function t(e){var t;vxJS.event.preventDefault(e),J||(S=this,vxJS.event.serve(M,"beforeSubmit"),u(),x?O({command:"submit"}):(d(),t=n(c.elements,this),vxJS.merge(t,r),L.use(null,t,{node:k}).submit(),b=t))}var r,y,a,s,l,x,b,S,w,C,J,N,T,e,E=[],D=[],M={},L=vxJS.xhr(o||{}),k=((e="div".setProp("class","vxJS_xhrThrobber").create()).style.position="absolute",vxJS.dom.setElementPosition(e,{x:-100,y:-100}),document.body.appendChild(e),e),A=function(){(s||a)&&(s&&(s.style.display="none"),a&&(a.style.display="none"))},O=function(e){var t,n,r,o,i,a,s=[],l=[];if(a=(e=e||this.response).response&&e.echo?e.response:e,D.forEach(function(e){vxJS.dom.deleteChildNodes(e.container)}),p(),f(),a){if(i=a.command){if("redirect"===i&&a.location)return void(window.location.href=a.location);if("submit"===i)return y&&g(),d(),vxJS.dom.addClassName(k,"active"),C=!0,u(),void c.submit()}if(a.elements){for(t=a.elements.length;t--;)(n=a.elements[t]).value&&s.push({name:n.name,value:n.value}),a.elements[t].error&&l.push({name:n.name,text:n.errorText||null,ndx:Array.isArray(n.ndx)?n.ndx:null});m(s),function(e){e.forEach(function(n){var e,t=c.elements[n.name];t?t.nodeName?(n.elements=[t],vxJS.dom.addClassName(t,"error")):(n.elements=vxJS.collectionToArray(t),n.elements.forEach(function(e,t){n.ndx&&-1===n.ndx.indexOf(t)||vxJS.dom.addClassName(e,"error")})):n.elements=[],(e=document.getElementById("error_"+n.name))&&(vxJS.dom.addClassName(e,"error"),n.text&&e.appendChild(document.createTextNode(n.text)))}),E=e}(l)}if(r=a.msgBoxes)for(t=r.length;t--;)r[t].id&&(o=v(r[t].id))&&o.appendChild(vxJS.dom.parse(r[t].elements))}N=e,vxJS.event.serve(M,"check",e)};return M.addSubmit=function(e){return vxJS.event.addListener(e,"click",t),this},M.addMessageBox=function(e,t){return D.push({container:e,id:t||"MsgBox"+D.length}),this},M.clearErrors=function(){return p(),this},M.getErrors=function(){return E},M.clearFileInputs=function(){var e,t=c.getElementsByTagName("input");if(t&&(e=t.length)){for(;--e;)"file"==t[e].type&&t[e].parentNode.replaceChild("input".setProp([["type","file"],["name",t[e].name]]).create(),t[e]);return this}},M.forceRequest=function(){var e;return vxJS.event.serve(M,"beforeSubmit"),e=n(c.elements,this),vxJS.merge(e,r),L.use(null,e,{node:k}).submit(),b=e,this},M.disableImmediateSubmit=function(){return x=!1,this},M.enableImmediateSubmit=function(){return x=!0,this},M.enableApcUpload=function(){var e;return void 0===y&&(y=!("multipart/form-data"!==c.enctype||!(e=c.elements.APC_UPLOAD_PROGRESS))&&e)&&(a=function(){var e=vxJS.dom.getElementsByClassName("apcProgressBar",c,"div")[0];if(e)return vxJS.dom.cleanDOM(e),e}(),s=function(){var e=vxJS.dom.getElementsByClassName("apcPercentage",c,"span")[0];if(e)return e.appendChild(document.createTextNode("")),e}(),A()),this},M.enableIframeUpload=function(){return function(){var e,t,n=c.action,r="ifu_"+(new Date).getTime();w||(w="iframe".setProp([["name",r],["src","javascript:false;"]]).create(),(t=(e="div".create(w)).style).visibility="hidden",t.overflow="hidden",vxJS.dom.setElementSize(e,new Coord(0,0)),document.body.appendChild(e),c.target=r,o.command&&(c.action=n+(-1==n.indexOf("?")?"?":"&")+"ifuRequest="+o.command),vxJS.event.addListener(w,"load",i))}(),this},M.setValues=function(e){for(var t=Object.keys(e),n=t.length,r=[];n--;)r.push({name:t[n],value:e[t[n]]});return m(r),this},M.getSubmittedValues=function(){return b},M.getLastXhrResponse=function(){return N},M.setPayload=function(e){return r=e,this},M.clearPayload=function(){return r=null,this},M.isSubmittingNow=function(){return J},vxJS.event.addListener(L,"complete",O),vxJS.event.addListener(L,"fail",f),vxJS.event.addListener(L,"timeout",f),M.element=c,M.xhr=L,M},vxJS.widget.calendar=function(i,h,m){"object"!=typeof h&&(h={});var a,t,p,v,n,r,g,y,x,b,S,w,C,J=document.createTextNode(""),s=h.alignTo||i,N=document.createDocumentFragment(),l={},e=new Date,T=new Date(e.getFullYear(),e.getMonth(),e.getDate()),E=h.initDate&&h.initDate.constructor===Date?h.initDate:null,D=h.inputLocale||"date_de",c=h.outputFormat||("date_de"===D?"%D.%M.%Y":"%Y-%M-%D"),M=(h.months||"Jan Feb März Apr Mai Juni Juli Aug Sept Okt Nov Dez").split(" "),L=h.showCw;h.noPast&&(b=h.noPast.constructor===Date?h.noPast:T),h.noFuture&&(S=h.noFuture.constructor===Date?h.noFuture:T);function o(){var e=i.value.trim();return/^\d\d?[ \/\-\.]+(?:\d{2}|\d{4})$/.test(e)?function(e,t){t=t||(new Date).getFullYear();var n=7*(e-1)+1,r=new Date(t,0,1).getDay()||7;return new Date(t,0,n-r+(4<r?8:1))}((e=e.split(/[ \/\-\.]+/))[0],(""+(E||T).getFullYear()).slice(0,4-e[1].length)+e[1]):(e=e.toDateTime(D,!0))?e:void 0}function k(e){var t;for(t=0;t<7;++t)if(!g[7*e+t].disabled)return g[7*e+t]}function d(e){e&&e.constructor===Date||(e=new Date),x?(x.setMonth(e.getMonth()),x.setFullYear(e.getFullYear())):x=new Date(e.getFullYear(),e.getMonth(),1)}function u(){var e,t,n,r,o,i,a=x.getMonth(),s=x.getFullYear(),l=new Date(s,a+1,0),c=l.getDate(),d=new Date(s,a,"date_us"===D?1:0).getDay(),u=(("date_us"===D?6:7)-l.getDay())%7,f=new Date(s,a,1-d);for(h.noYearInput?J.nodeValue=M[a]+" "+s:(J.nodeValue=M[a],p.value=s),g=[],n=1-d;n<=c+u;++n)r=[],i=new Date(s,a,n),(n+d-1)%7||(t="tr".create(),N.appendChild(t)),(b&&i<b||S&&S<i)&&r.push("disabled"),(n<1||c<n)&&r.push("trail"),i.toString()===T.toString()&&r.push("today"),E&&i.toString()===E.toString()&&r.push("marked"),t.appendChild("td".setProp("class",r.join(" ")).create(i.getDate())),g[n+d-1]={date:i,elem:t.lastChild,disabled:-1!=r.indexOf("disabled")};if(N.appendChild(t),L)for(y=[],e=e||f.getCW("date_us"===D),o=N.childNodes,n=0;n<o.length;++n)52<e&&(e=g[7*n].date.getCW("date_us"===D)),o[n].appendChild("td".create(e++)),o[n].lastChild.className="weekCell"+(k(n)?"":" disabled"),y.push(o[n].lastChild);v.replaceChild("tbody".create(N),v.childNodes[1]),w&&(w.use(m,{date:x.getFullYear()+"-"+("0"+(x.getMonth()+1)).slice(-2)+"-01"}).submit(),C=!0,vxJS.dom.addClassName(v,"xhrActive"))}function f(){var e;t||(i&&(e=o())&&(E=e),d(E),u(),s&&function(){var e,t,n=vxJS.dom.getElementOffset(s),r=vxJS.dom.getElementSize(s),o=vxJS.dom.getDocumentScroll(),i=a.style;i.visibility="hidden",i.display="",e=vxJS.dom.getElementSize(a),i.display="none",i.visibility="visible",t=n.y+r.y+e.y>vxJS.dom.getViewportSize().y+o.y&&n.y-e.y>o.y?n.y-e.y:n.y+r.y,vxJS.dom.setElementPosition(a,new Coord(n.x,t))}(),"function"==typeof h.customShow?h.customShow.apply(l):a.style.display="",t=!0,vxJS.event.serve(l,"showWidget"))}function A(){t&&("function"==typeof h.customHide?h.customHide.apply(l):a.style.display="none",t=!1,vxJS.event.serve(l,"hideWidget"))}function O(e){i&&i.disabled||(vxJS.event.cancelBubbling(e),vxJS.event.removeListener(n),r=vxJS.event.addListener(document,"click",I),f())}if(function(){var e,t=["span".setProp("class","prevMon").create(),"span".setProp("class","mon").create(J),"span".setProp("class","nextMon").create()];switch(v="table".create(["thead".create(),"tbody".create()]),h.noYearInput||(p="input".setProp([["maxLength",4],["class","year"]]).create(),t=["div".setProp("class","selMon").create(t),"div".setProp("class","selYear").create(["span".setProp("class","prevYear").create("«"),p,"span".setProp("class","nextYear").create("»")])]),a="div".setProp("class",h.skinClass||"vxJS_calendar").create("div".create(["div".setProp("class","vxJS_dragBar").create(t),v])),D){case"date_us":e="S,M,T,W,T,F,S,CW";break;case"date_iso":e="M,T,W,T,F,S,S,CW";break;default:e="M,D,M,D,F,S,S,KW"}e=e.split(","),L||e.pop(),v.firstChild.appendChild("tr".create(e.domWrapWithTag("th"))),p&&(vxJS.event.addListener(p,"blur",function(){var e;/^\d{2,}$/.test(this.value)&&(e=parseInt((""+(new Date).getFullYear()).slice(0,4-this.value.length)+this.value,10))!==x.getFullYear()&&(x.setFullYear(e),u(),vxJS.event.serve(l,"yearChange")),this.value=x.getFullYear()}),vxJS.event.addListener(p,"keydown",function(e){switch(e.keyCode){case 27:this.value=x.getFullYear();case 13:this.blur()}}));vxJS.event.addListener(a,"click",function(e){var t,n,r,o=this.className;switch(o){case"prevMon":x.setMonth(x.getMonth()-1),u(),t="monthChange";break;case"nextMon":x.setMonth(x.getMonth()+1),u(),t="monthChange";break;case"prevYear":x.setFullYear(x.getFullYear()-1),u(),t="yearChange";break;case"nextYear":x.setFullYear(x.getFullYear()+1),u(),t="yearChange";break;default:if(C)return;(n="td"==this.nodeName.toLowerCase()?this:vxJS.dom.getParentElement(this,"td"))&&(7==n.cellIndex&&(r=k(n.parentNode.rowIndex-1).date)?t="datePick":(o=g[7*(n.parentNode.rowIndex-1)+n.cellIndex]).disabled||(r=o.date,t="datePick",h.dontHide&&function(e){var t=vxJS.dom.getElementsByClassName("marked",v)[0];t&&vxJS.dom.removeClassName(t,"marked"),vxJS.dom.addClassName(e,"marked")}(n)))}t&&("datePick"===t&&(E=r,i&&(i.value=r.format(c)),I()),vxJS.event.serve(l,t)),vxJS.event.cancelBubbling(e)}),h.dontHide||(a.style.display="none",a.style.position="absolute",document.body.appendChild(a))}(),m&&(w=vxJS.xhr(),vxJS.event.addListener(w,"complete",function(){var e,t,n=this.response.entries,r=g[0].date,o=r.getMonth(),i=o!==x.getMonth()?new Date(r.getFullYear(),o+1,0).getDate()-r.getDate():-1;if(C=!1,vxJS.dom.removeClassName(v,"xhrActive"),n&&(e=n.length))for(;e--;)(t=+n[e].day)&&0<=t+i&&g[t+i]&&(n[e].disabled&&(vxJS.dom.addClassName(g[t+i].elem,"disabled"),g[t+i].disabled=!0),n[e].label&&g[t+i].elem.appendChild("div".create(n[e].label)))}),vxJS.event.addListener(w,"timeout",function(){C=!1,vxJS.dom.removeClassName(v,"xhrActive")})),h.trigger&&!h.dontHide){n=vxJS.event.addListener(h.trigger,h.eType||"click",O);var I=function(){vxJS.event.removeListener(r),n=vxJS.event.addListener(h.trigger,h.eType||"click",O),A()}}else i?(E=E||o(),d(E)):d(),u(),I=function(){A()};return i&&vxJS.event.addListener(i,"keydown",function(e){var t,n=e.keyCode;13==n&&h.dontHide&&(t=o(),E&&t.toString()==E.toString()||(d(E=t),u())),-1!==[9,13,27].indexOf(n)&&I()}),l.element=a,l.show=f,l.hide=A,l.getDate=function(){return E},l.setDate=function(e){e&&e.constructor===Date&&!isNaN(e)&&(d(E=e),u())},l.clearDate=function(){E=null,d(T),u()},l},vxJS.widget.sorTable=function(n,r){function o(e){var t,n,r=vxJS.event.getAbsMousePos(e),o=h.pos.y,i=h.elem;if(r.y<o&&(t=vxJS.dom.prevSameNodeNameSibling(i))&&r.y<(o-=t.offsetHeight/2)){for(;(n=vxJS.dom.prevSameNodeNameSibling(t))&&!(r.y>o-t.offsetHeight/2-n.offsetHeight/2);)o-=t.offsetHeight,t=n;if(S==t)return;w(),S.above=t,vxJS.dom.addClassName(t,"insertAbove")}else if(r.y>(o+=i.offsetHeight)&&(t=vxJS.dom.nextSameNodeNameSibling(i))&&r.y>(o+=t.offsetHeight/2)){for(;(n=vxJS.dom.nextSameNodeNameSibling(t))&&!(r.y<o+t.offsetHeight/2+n.offsetHeight/2);)o+=t.offsetHeight,t=n;if(S==t)return;w(),S.below=t,vxJS.dom.addClassName(t,"insertBelow")}else w();vxJS.event.preventDefault(e)}function i(){vxJS.event.removeListener(m),vxJS.event.removeListener(p),S.above?S.above.parentNode.insertBefore(h.elem,S.above):S.below&&S.below.parentNode.insertBefore(h.elem,S.below.nextSibling),(S.below||S.above)&&(C(f),f=null),vxJS.event.serve(b,"dragStop"),vxJS.dom.removeClassName(h.elem,"dragged"),w(),h=null}function a(e){for(var t=this;t&&t.parentNode.parentNode!=d;)t=t.parentNode;t&&"manual"===y[t.cellIndex].format&&(p=vxJS.event.addListener(document,"mousemove",o),m=vxJS.event.addListener(document,"mouseup",i),h={elem:t.parentNode,pos:vxJS.dom.getElementOffset(t.parentNode)},vxJS.dom.addClassName(h.elem,"dragged"),vxJS.event.serve(b,"dragStart"),vxJS.event.preventDefault(e))}function s(e){var t=g.length;if(e)for(vxJS.dom.removeClassName(e.elem,"vxJS_sorTable_header_"+(e.asc?"desc":"asc")),vxJS.dom.addClassName(e.elem,"vxJS_sorTable_header_"+(e.asc?"asc":"desc"));t--;)vxJS.dom.addClassName(g[t].cells[e.ndx],"active")}function l(){f&&(vxJS.event.serve(b,"beginSort"),function(e){var t=document.createDocumentFragment(),n=0;for(g=[];e[n];)g[n]=e[n].element,t.appendChild(g[n++]);d.appendChild(t)}(function(e){var t,n=g.length,r=y[e].format,o=[],i={float:function(e){return/^[+\-]?(?:\d{1,3}(?:[ ,\x27]\d{3})+|\d+)(?:\.\d+)?$/.test(e)?e.replace(/[^0-9.\-]/g,""):e},float_comma:function(e){return/^[+\-]?(?:\d{1,3}(?:[ .\x27]\d{3})+|\d+)(?:,\d+)?$/.test(e)?e.replace(/[^0-9,\-]/g,"").replace(",","."):e},date:function(e,t){var n=e.toDateTime(t,!0);return n?n.format("%Y-%M-%D"):e},time:function(e,t){return e.toDateTime(t)}};if(r&&/^(date_|time_)[a-z]+$/.test(r)&&(r=r.split("_")[0]),r&&"function"!=typeof r)for(;n--;)t=g[n],o[n]={element:t,value:i[r](vxJS.dom.concatText(g[n].cells[e]),y[e].format)};else for(;n--;)t=g[n],o[n]={element:t,value:vxJS.dom.concatText(t.cells[e]).toLowerCase()};return o}(f.ndx).sort("function"==typeof f.format?f.format.bind(f):function(){var n=this.asc?1:-1;return/^(?:float|float_comma)$/.test(this.format)?function(e,t){return e=+e.value,isNaN(e)?1:(t=+t.value,isNaN(t)?-1:e===t?0:e<t?-n:n)}:function(e,t){return e.value===t.value?0:e.value<t.value?-n:n}}.bind(f)())),vxJS.event.serve(b,"finishSort"))}function e(){for(var e,t,n=this;!/th|td/i.test(n.nodeName)&&n.parentNode;)n=n.parentNode;void 0!==(t=n.cellIndex)&&(e=y[t],/^no_sort|manual$/.test(e.format)||(C(f),e===f?e.asc=!e.asc:f=e,s(e),l()))}var c,d,u,f,h,m,p,t,v=(r=r||{}).columnFormat&&r.columnFormat.length?r.columnFormat:[],g=[],y=[],x=[],b={},S={},w=function(){S.above?(vxJS.dom.removeClassName(S.above,"insertAbove"),S.above=null):S.below&&(vxJS.dom.removeClassName(S.below,"insertBelow"),S.below=null)},C=function(e){var t=g.length;if(e)for(vxJS.dom.removeClassName(e.elem,"vxJS_sorTable_header_"+(e.asc?"asc":"desc"));t--;)vxJS.dom.removeClassName(g[t].cells[e.ndx],"active")};return b.getActiveColumn=function(){return f},b.initSort=function(){g=vxJS.collectionToArray(d.rows),x=[].concat(g),f&&s(f)},b.getCurrentOrder=function(){var e,t=g.length,n=[];for(e=0;e<t;++e)n.push(x.indexOf(d.rows[e]));return n},b.insertRow=function(e,t){(+t>g.length||void 0===t)&&(t=g.length),x.splice(t,0,e),g.splice(t,0,e),d.insertBefore(e,g[t+1]||null),f&&vxJS.dom.addClassName(e.cells[f.ndx],"active")},b.removeRow=function(e){x.splice(x.indexOf(e),1),g.splice(g.indexOf(e),1),d.removeChild(e)},b.removeAllRows=function(){var e;for(x=[],g=[];e=d.lastChild;)d.removeChild(e)},b.updateRow=function(r,e){Array.isArray(e)&&(r.nodeName&&"tr"!=!r.nodeName.toLowerCase()||(r=g[+ndx]),e.forEach(function(e,t){var n=r.cells[t];null!==e&&(vxJS.dom.deleteChildNodes(n),e.nodeType?n.appendChild(e):n.appendChild(document.createTextNode(e)))}))},b.sortBy=function(e,t){var n=y[e];/^no_sort|manual$/.test(n.format)||(n.asc=!t||"asc"==t.toLowerCase(),n!==f&&(C(f),f=n),s(n),l())},b.enableSort=function(){t||(t=vxJS.event.addListener(c.rows[void 0===r.activeHeaderRowIndex?c.rows.length-1:r.activeHeaderRowIndex],"click",e),vxJS.dom.removeClassName(c,"disabled"))},b.disableSort=function(){t&&(vxJS.event.removeListener(t),vxJS.dom.addClassName(c,"disabled"),t=null)},b.getDraggedRow=function(){return h.elem},b.reSort=l,function(){var e,t;if("tbody"===n.nodeName.toLowerCase())n=(d=n).parentNode;else{if("table"!==n.nodeName.toLowerCase())throw new Error("vxJS.widget.sorTable: No valid table or tbody element.");d=n.tBodies[0]}if(!(c=n.getElementsByTagName("thead")[0])&&!d)throw new Error("vxJS.widget.sorTable: neither tbody nor thead element found.");for(c||(c="thead".create(),d.parentNode.insertBefore(c,d),c.appendChild(d.rows[0])),d||(d="tbody".create(),c.parentNode.appendChild(d)),t=void 0===r.activeHeaderRowIndex?c.rows.length-1:r.activeHeaderRowIndex,u=c.rows[t].cells.length,-1!==v.indexOf("manual")&&vxJS.event.addListener(d,"mousedown",a),e=0;e<u;++e)y.push({ndx:e,elem:c.rows[t].cells[e],format:v[e],asc:!0});b.initSort(),b.enableSort()}(),b.element=d,b},vxJS.widget.simpleTabs=function(){function f(e,t,n,r){this.tabBar=e,this.label=t.trim(),this.page=n,this.id=r,this.render()}var h={},m=[],p=vxJS.hasHostMethods(window.history,["pushState","replaceState"]);f.prototype={render:function(){var e,t,n,r,o,i=h.tabWrap,a=h.shortenLabelsTo&&this.label.length>h.shortenLabelsTo?(r=this.label,o=h.shortenLabelsTo,r.slice(0,Math.ceil(o/2))+"..."+r.slice(-Math.floor(o/2))):this.label,s=h.shortenLabelsTo&&this.label.length>h.shortenLabelsTo?this.label:"";if(t=this.id?"a".setProp("href",h.setHash?"#"+this.id:"").create(a):document.createTextNode(a),e="li".setProp("title",s).create(),i)if("string"==typeof i)e.appendChild(i.create(t));else{for(n=i.length;n--;)t=i[n].create(t);e.appendChild(t)}else e.appendChild(t);return this.element=e,this},focus:function(){var e=this.element.getElementsByTagName("a");return e&&e[0]&&e[0].focus(),this},show:function(){return this.visibilty=!0,vxJS.dom.addClassName(this.element,"shown"),this.page.style.display="",this},hide:function(){return this.visibilty=!1,vxJS.dom.removeClassName(this.element,"shown"),this.page.style.display="none",this}};function v(e){this.tabs=[],this.container=e}return v.prototype={enable:function(){return this.inactive=!1,vxJS.dom.removeClassName(this.element,"disabled"),this},disable:function(){return this.inactive=!0,vxJS.dom.addClassName(this.element,"disabled"),this},getTabByElement:function(e){for(var t=this.tabs.length;t--;)if(this.tabs[t].element===e)return this.tabs[t]},getTabByNdx:function(e){return this.tabs[e]},getTabById:function(e){for(var t=this.tabs.length;t--;)if(this.tabs[t].id===e)return this.tabs[t]},getTabNdx:function(e){for(var t=this.tabs.length;t--;)if(this.tabs[t]===e)return t},gotoTab:function(e,t){var n=this.last;if(e&&-1!==this.tabs.indexOf(e)&&n!==e)return n.hide(),e.show(),this.last=e,t&&e.id&&h.setHash&&(p?window.history.pushState(e.id,"","#"+e.id):window.location="#"+e.id),this},gotoPrevTab:function(e){return this.gotoTab(this.last.prevTab,e)},gotoNextTab:function(e){return this.gotoTab(this.last.nextTab,e)},focus:function(e,t){return this.gotoTab(e,t),e.focus(),this},insertTab:function(e,t){var n,r=new f(this,e.label,e.page,e.id);return r.hide(),t?((n=t.prevTab)&&(n.nextTab=r),(t.prevTab=r).prevTab=n,r.nextTab=t,this.tabs.splice(this.getTabNdx(t),0,r),this.container.insertBefore(e.page,t.page),this.ulElement.insertBefore(r.element,t.element)):(((n=this.tabs[this.tabs.length-1]).nextTab=r).nextTab=null,r.prevTab=n,this.tabs.push(r),this.container.insertBefore(e.page,n.page.nextSibling),this.ulElement.insertBefore(r.element,n.element.nextSibling)),this},removeTab:function(e){var t=this.getTabNdx(e);return e.prevTab&&(e.prevTab.nextTab=e.nextTab),e.nextTab&&(e.nextTab.prevTab=e.prevTab),this.container.removeChild(e.page),this.ulElement.removeChild(e.element),this.tabs.splice(t,1),this}},p&&vxJS.event.addListener(window,"popstate",function(e){var t,n=m.length;if(e.state)for(;n--&&!(t=m[n].getTabById(e.state)););t&&m[n].gotoTab(t,!1)}),function(e,t){var n=vxJS.dom.getElementsByClassName("vxJS_tabThis",e),r=n.length,d=window.location.hash.slice(1)||"";h=t||{};for(var u=function(e,t){var n=t.getTabByElement(this.nodeName&&"LI"===this.nodeName.toUpperCase()?this:vxJS.dom.getParentElement(this,"li"));n&&(t.inactive||(vxJS.event.serve(t,"beforeTabClick"),t.gotoTab(n,!0),vxJS.event.serve(t,"afterTabClick")),vxJS.event.preventDefault(e))};r--;)!function(e){var t,n,r,o,i,a,s,l=vxJS.dom.getElementsByClassName("section",e),c=new v(e);for(o=0,i=l.length;o<i;++o)(t=l[o].getElementsByTagName("h2"))[0]&&(a=t[0].id,(s=new f(c,vxJS.dom.concatText(t[0]),l[o],a)).hide(),t[0].parentNode.removeChild(t[0]),c.tabs.push(s),(a&&a===d||!r&&vxJS.dom.hasClassName(l[o],"default"))&&(r=s));if(i=c.tabs.length){for(r=r||c.tabs[0],n="ul".create(),o=0;o<i;++o)(s=c.tabs)[o].nextTab=s[o+1]||null,s[o].prevTab=0<=o-1?s[o-1]:null,n.appendChild(s[o].element);r.show(),c.last=r,c.ulElement=n,c.element="div".setProp("class","vxJS_tabBar").create([h.spacersTop,n,h.spacersBottom]),e.insertBefore(c.element,e.firstChild),vxJS.event.addListener(c,"click",u),m.push(c),p&&r.id&&h.setHash&&window.history.replaceState(r.id,"","#"+r.id)}}(n[r]);return m}}();