"use strict";var Coord=function(e,t){this.x=+e?parseInt(e,10):0,this.y=+t?parseInt(t,10):0};Coord.prototype={add:function(e){return new Coord(this.x+(+e.x?parseInt(e.x,10):0),this.y+(+e.y?parseInt(e.y,10):0))},sub:function(e){return new Coord(this.x-(+e.x?parseInt(e.x,10):0),this.y-(+e.y?parseInt(e.y,10):0))},len:function(){return Math.sqrt(this.x*this.x+this.y*this.y)}};var Color=function(e){var t,n,r,o;if(!e)return this.r=0,this.g=0,this.b=0,void(this.a=1);/rgb\s*\(\s*\d{1,3}\s*,\s*\d{1,3}\s*,\s*\d{1,3}\s*(?:,\s(?:1|0)(?:\.\d+)?\s*)?\)/.test(e)?(t=+(e=e.slice(e.indexOf("(")+1,-1).split(","))[0],n=+e[1],r=+e[2],o=+e[3]):"#"===e.slice(0,1)&&(4===e.length?(t=parseInt(e.slice(1,2)+e.slice(1,2),16),n=parseInt(e.slice(2,3)+e.slice(2,3),16),r=parseInt(e.slice(3)+e.slice(3),16)):(t=parseInt(e.slice(1,3),16),n=parseInt(e.slice(3,5),16),r=parseInt(e.slice(5,7),16),o=parseInt(e.slice(7),16))),this.r=isNaN(t)||t>255?255:t,this.g=isNaN(n)||n>255?255:n,this.b=isNaN(r)||r>255?255:r,this.a=isNaN(o)||o>1?1:o};if(Color.prototype={toHex:function(){return"#"+("00"+Math.round(this.r).toString(16)).slice(-2)+("00"+Math.round(this.g).toString(16)).slice(-2)+("00"+Math.round(this.b).toString(16)).slice(-2)},toRGB:function(){return"rgb("+Math.round(this.r)+","+Math.round(this.g)+","+Math.round(this.b)+")"}},"function"!=typeof Function.prototype.bind&&(Function.prototype.bind=function(e){var t=Array.prototype.slice,n=t.call(arguments,1),r=this,o=function(){},i=function(){return r.apply(this instanceof o?this:e,n.concat(t.call(arguments,0)))};return o.prototype=r.prototype,i.prototype=new o,i}),Object.keys||(Object.keys=function(e){var t,n=[];for(t in e)e.hasOwnProperty(t)&&n.push(t);return n}),Object.create||(Object.create=function(e){if(arguments.length>1)throw new Error("Object.create polyfill allows only one parameter.");function t(){}return t.prototype=e,new t}),Array.isArray||(Array.isArray=function(e){return"[object Array]"==Object.prototype.toString.call(e)}),Array.prototype.forEach||(Array.prototype.forEach=function(e,t){for(var n=0,r=this.length;n<r;++n)n in this&&e.call(t,this[n],n,this)}),Array.prototype.map||(Array.prototype.map=function(e,t){for(var n=0,r=this.length,o=new Array(r);n<r;++n)n in this&&(o[n]=e.call(t,this[n],n,this));return o}),Array.prototype.filter||(Array.prototype.filter=function(e,t){for(var n,r=0,o=this.length,i=[];r<o;++r)r in this&&(n=this[r],e.call(t,n,r,this)&&i.push(n));return i}),Array.prototype.indexOf||(Array.prototype.indexOf=function(e,t){var n=this.length,r=+t||0;for(r=r<0?Math.ceil(r)+n:Math.floor(r);r<n;++r)if(r in this&&this[r]===e)return r;return-1}),String.prototype.trim||function(){var e=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;String.prototype.trim=function(){return this.replace(e,"")}}(),Array.prototype.copy=function(){return this.slice(0)},Array.prototype.fill||(Array.prototype.fill=function(e){for(var t=Object(this),n=+t.length||0,r=+arguments[1]||0,o=void 0===arguments[2]?n:+o||0,i=r<0?Math.max(n+r,0):Math.min(r,n),a=o>0?Math.max(n+o,0):Math.min(o,n);i<a;)t[i++]=e;return t}),Array.prototype.swap=function(e,t){if(void 0===t&&(t=++e),!(e<0||e>=this.length||t<0||t>=this.length)){var n=this[e];this[e]=this[t],this[t]=n}},Array.prototype.inArray=function(e){return!(-1==this.indexOf(e))},Number.prototype.toFormattedString=function(e,t,n){var r,o="";if(t=t||".",n=n||",",e="number"==typeof e?Math.round(e):0,r=this.toFixed(e).toString().split("."),n){for(;r[0].length>3;)o=n+r[0].slice(-3)+o,r[0]=r[0].slice(0,-3);r[0]=r[0]+o}return(this<0?"-":"")+r[0]+(r[1]?t+r[1]:"")},String.prototype.lpad=function(e,t){for(var n=e-this.length,r="",o=t||" ";--n>=0;)r+=o;return r+this},String.prototype.rpad=function(e,t){for(var n=e-this.length,r="",o=t||" ";--n>=0;)r+=o;return this+r},String.prototype.shortenToLen=function(e){if(this.length<e)return String(this);var t=this.lastIndexOf(" ",e);return-1==t?this.slice(0,e):this.slice(0,t).replace(/\s+$/g,"")},String.prototype.toFloat=function(e){var t,n,r;return(t=this.split(e||".")).length>2?NaN:t[1]&&!(n=parseInt(t[1],10))?NaN:(r=t[0].replace(/[^0-9]/g,""))?parseFloat(r+"."+n):NaN},String.prototype.toDateTime=function(e,t){var n,r,o,i,a,s,l,c,d,u=this.trim();switch(e=e||"date_de"){case"date_us":case"date_de":if(!(n=u.match(/^\d{1,2}([\/.\-])\d{1,2}\1\d{0,4}$/))&&/^([0-9]{4}|[0-9]{6}|[0-9]{8})$/.test(u))r=[u.slice(0,2),u.slice(2,4),u.slice(4)];else{if(!n||2!==n.length)return!1;if(3!==(r=u.split(n[1])).length)return!1}return o=[("00"+r[0]).slice(-2),("00"+r[1]).slice(-2),(""+(new Date).getFullYear()).slice(0,4-r[2].length)+r[2]],"date_us"==e?(i=+o[1],a=+o[0]):(i=+o[0],a=+o[1]),s=+o[2],a<1||a>12?!1:!(i<1||i>new Date(s,a,0).getDate())&&(t?new Date(s,a-1,i):(n="date_de"==e?".":"/",o[0]+n+o[1]+n+o[2]));case"date_iso":if(!(n=u.match(/^\d{2}(\d{2})?([\/.\-])\d{1,2}\2\d{1,2}$/))&&/^([0-9]{6}|[0-9]{8})$/.test(u))r=[u.slice(0,2),u.slice(2,4),u.slice(4)];else{if(!n||3!==n.length)return!1;if(3!==(r=u.split(n[2])).length)return!1}return s=+(o=[(""+(new Date).getFullYear()).slice(0,4-r[0].length)+r[0],("00"+r[1]).slice(-2),("00"+r[2]).slice(-2)])[0],a=+o[1],i=+o[2],!(a<1||a>12)&&(!(i<1||i>new Date(s,a,0).getDate())&&(t?new Date(s,a-1,i):o[0]+"-"+o[1]+"-"+o[2]));case"time_hm":if(!(n=u.match(/^\d{1,2}([:.\-])\d{1,2}$/))&&/^[0-9]{4}$/.test(u))r=[u.slice(0,2),u.slice(2)];else{if(!n||2!==n.length)return!1;if(2!==(r=u.split(n[1])).length)return!1}return!(+r[0]>23||+r[1]>59)&&("00"+r[0]).slice(-2)+":"+("00"+r[1]).slice(-2);case"time_hms":if(!(n=u.match(/^\d{1,2}([:.\-])\d{1,2}\1\d{1,2}$/))&&/^([0-9]{4}|[0-9]{6})$/.test(u))r=[u.slice(0,2),u.slice(2,4),u.slice(4)];else{if(!n||2!==n.length)return!1;if(3!==(r=u.split(n[1])).length)return!1}return l=+r[0],c=+r[1],d=+r[2],!(l>23||c>59||d>59)&&("00"+l).slice(-2)+":"+("00"+c).slice(-2)+":"+("00"+d).slice(-2)}},String.prototype.toUcFirst=function(){return this.slice(0,1).toUpperCase()+this.slice(1)},Date.prototype.format=function(e){var t=this,n={"%h":function(){return""+t.getHours()},"%H":function(){return(""+t.getHours()).lpad(2,"0")},"%i":function(){return""+t.getMinutes()},"%I":function(){return(""+t.getMinutes()).lpad(2,"0")},"%s":function(){return""+t.getSeconds()},"%S":function(){return(""+t.getSeconds()).lpad(2,"0")},"%d":function(){return""+t.getDate()},"%D":function(){return(""+t.getDate()).lpad(2,"0")},"%m":function(){return""+(t.getMonth()+1)},"%M":function(){return(""+(t.getMonth()+1)).lpad(2,"0")},"%y":function(){return(""+t.getFullYear()).slice(-2)},"%Y":function(){return""+t.getFullYear()},"%w":function(){return""+t.getCW()},"%W":function(){return(""+t.getCW()).lpad(2,"0")},"%z":function(){var e=t.getCW(),n=t.getMonth();return""+(1===e&&11===n?t.getFullYear()+1:e>=52&&!n?t.getFullYear()-1:t.getFullYear())},"%Z":function(){var e=t.getCW(),n=t.getMonth();return(""+(1===e&&11===n?t.getFullYear()+1:e>=52&&!n?t.getFullYear()-1:t.getFullYear())).lpad(2,"0")}};return e.replace(/%[hisdmywz]{1}/gi,function(e){return n[e]()})},Date.prototype.getAbsoluteDays=function(){return Math.floor(.1+this.getTime()/864e5)},Date.prototype.getCW=function(e){if(!e){var t=this.getDay()||7,n=this.getAbsoluteDays(),r=new Date(new Date(864e5*(n+4-t)).getFullYear(),0,-10);return Math.floor((n-t-r.getAbsoluteDays())/7)}var o=new Date(this.getFullYear(),0,1).getAbsoluteDays();if(0===new Date(this.getFullYear(),0,1).getDay())return Math.floor((this.getAbsoluteDays()-o)/7)+1},String.prototype.create=function(e){var t,n,r=document.createElement(this);if(this.attr){for(t=this.attr.length;t--;)if("name"===this.attr[t].name){try{r=document.createElement("<"+this+" name="+this.attr[t].value+">")}catch(e){}break}for(t=this.attr.length;t--;)"class"===(n=this.attr[t]).name?r.className=n.value:"type"===n.name?r.setAttribute(n.name,n.value):r[n.name]=n.value}return vxJS.dom.appendChildren(r,e)},String.prototype.setProp=function(e,t){var n,r=new String(this);if(r.attr||(r.attr=[]),arguments.length>1&&r.attr.push({name:e,value:t}),1===arguments.length)if(Array.isArray(e))for(n=e.length;n--;)r.attr.push({name:e[n][0],value:e[n][1]});else if("object"==typeof e)for(n in e)e.hasOwnProperty(n)&&r.attr.push({name:n,value:e[n]});return r},Array.prototype.create=function(e){var t,n=[];for(t=0;t<this.length;++t)n[t]=this[t].create(e);return n},Array.prototype.setProp=function(e,t){for(var n=this.length;n--;)this[n]=this[n].setProp(e,t);return this},Array.prototype.domWrapWithTag=function(e){var t,n,r="acronym|address|applet|area|a|base|basefont|big|blockquote|body|br|b|caption|center|cite|code|dd|dfn|dir|div|dl|dt|em|font|form|h1|h2|h3|h4|h5|h6|head|hr|html|img|input|i|kbd|link|li|map|menu|meta|ol|option|param|pre|p|q|samp|script|select|small|strike|strong|style|sub|sup|table|tbody|td|textarea|th|title|tr|tt|ul|u|var".split("|");if("string"==typeof e)for(t=0;t<this.length;++t)r.inArray(this[t])?this[t]=e.create(this[t].create()):this[t]=e.create(this[t]);else for(t=0;t<this.length;++t)for(n=0;n<e.length;++n)this[t]=e[n].create(this[t]);return this},function(){var e,t,n,r,o=["webkit","moz"],i=o.length,a=0;for(e=0;e<i&&!window.requestAnimationFrame;++e)t=o[e],window.requestAnimationFrame=window[t+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t+"CancelAnimationFrame"]||window[t+"CancelRequestAnimationFrame"];window.requestAnimationFrame&&window.cancelAnimationFrame||(window.requestAnimationFrame=function(e){return n=+new Date,r=Math.max(a+16,n),setTimeout(function(){e(a=r)},r-n)},window.cancelAnimationFrame=clearTimeout)}(),!this.vxJS)var vxJS={};!function(e){var t,n,r,o,i,a,s,l,c,d,u,f,h,m,p,v,g,y={isHM:/^(object|function)$/i,isNumberOrString:/^(string|number)$/,blanks:/\s+/},b=e.document,x=b.documentElement,S=function(e,t){var n=typeof e[t];return!!(y.isHM.test(n)&&e[t]||"unknown"===n)},w=function(e,t){for(var n=t.length;n--;)if(!S(e,t[n]))return!1;return!0},C="function"==typeof Object.assign?Object.assign:function(e,t){var n,r;if("object"!=typeof e)throw new TypeError("Cannot convert first argument to object");for(r=1;r<arguments.length;++r)if(null!==(t=arguments[r])&&void 0!==t)for(n in t=Object(arguments[r]))t.hasOwnProperty(n)&&(e[n]=t[n]);return e},N=function(e){for(var t=[],n=e.length,r=0;r<n;)t.push(e[r++]);return t};if(!e.localStorage){var J=document.createElement("div"),T="localStorage";J.style.display="none",b.getElementsByTagName("head")[0].appendChild(J),J.addBehavior&&(J.addBehavior("#default#userdata"),J.load(T),e.localStorage={setItem:function(e,t){J.load(T),J.getAttribute(e)||++this.length,J.setAttribute(e,t),J.save(T)},getItem:function(e){return J.load(T),J.getAttribute(e)},removeItem:function(e){J.load(T),J.removeAttribute(e),J.save(T),this.length&&--this.length},clear:function(){var e,t=0;for(J.load(T);e=J.XMLDocument.documentElement.attributes[t++];)J.removeAttribute(e.name);J.save(T),this.length=0},key:function(e){return J.load(T),J.XMLDocument.documentElement.attributes[e]},length:J.XMLDocument.documentElement.attributes.length})}vxJS.element={register:function(e){var n=function(e){for(var n,r=t.length,o=e.nodeType&&1===e.nodeType?"element":"widget";r--;)if((n=t[r])[o]&&n[o]===e)return n}(e);return n||(n=new vxJS.E,e.element&&1===e.element.nodeType?(n.element=e.element,n.widget=e):e.nodeType&&1===e.nodeType&&(n.element=e),t.push(n)),n},registry:t=[]},vxJS.E=function(){},vxJS.E.prototype={addListener:function(e,t){return vxJS.event.addListener(this,e,t),this},removeListener:function(e){return vxJS.event.removeListener(this,e),this}},vxJS.event=(r=w(document,["createEvent","addEventListener","removeEventListener"])?"W3C":w(document,["fireEvent","attachEvent","detachEvent"])?"MS":"legacy",o=[],i={},a=0,s={},l=[],c=function(t,n){var r=t.element||t;return i[n]||(i[n]=[]),i[n].inArray(r)||(i[n].push(r),"function"==typeof r["on"+n]&&o.push({id:0,elem:t,type:n,callback:r["on"+n],custom:!1}),r["on"+n]=function(i){i||(i=e.event);var a,s,l=i.target||i.srcElement||r;for(a=0,s=o.length;a<s;++a)o[a].elem===t&&o[a].type===i.type&&o[a].callback.apply(l,[i,t]);"mousewheel"==n&&vxJS.event.preventDefault(i)}),r["on"+n]},{fireEvent:function(e,t){switch(r){case"W3C":var n=document.createEvent("Event");return n.initEvent(t,!0,!0),void e.dispatchEvent(n);case"MS":return void e.fireEvent("on"+t,document.createEventObject());default:e["on"+t]()}},addDomReadyListener:(n=function(e){for(var t=0,n=l.length;t<n;++t)l[t](e)},S(b,"addEventListener")?b.addEventListener("DOMContentLoaded",n,!1):S(e,"addEventListener")?e.addEventListener("load",n,!1):S(e,"attachEvent")?e.attachEvent("onload",n):("function"==typeof e.onload&&l.push(e.onload),e.onload=n),function(e){l.push(e)}),addXhrListener:function(e,t){var n="__ID__"+a++;return o.push({id:n,elem:"xhr",type:e,fn:null,callback:t,custom:!0}),n},addMousewheelListener:function(t,n){var i,s="__ID__"+a++,l="mousewheel";switch(r){case"W3C":i=function(e){n.apply(e.target,[e,t]),vxJS.event.preventDefault(e)},t.addEventListener(l,i,!1),t.addEventListener("DOMMouseScroll",i,!1),l=["mousewheel","DOMMouseScroll"];break;case"MS":t.attachEvent("onmousewheel",i=function(){n.apply(e.event.srcElement,[e.event,t]),vxJS.event.preventDefault(e.event)});break;default:i=c(t,"mousewheel")}return o.push({id:s,elem:t,type:l,fn:i,callback:n,custom:!1}),s},removeMousewheelListener:function(e,t){this.removeListener(e,"string"==typeof e||t?t:"mousewheel")},addListener:function(t,n,i){var s,l,d="__ID__"+a++,u=t.element;if(l=t.nodeType&&1===t.nodeType||t===b||t===window||u&&!this.isCustomEvent(u,n))switch(r){case"W3C":(u||t).addEventListener(n,s=function(e){i.apply(e.target,[e,t])},!1);break;case"MS":(u||t).attachEvent("on"+n,s=function(n){i.apply((n||e.event).srcElement,[n||e.event,t])});break;default:s=c(t,n)}else s=function(e){i.call(t,e)};return o.push({id:d,elem:t,type:n,fn:s,callback:i,custom:!l}),d},removeListener:function(e,t){var n,i;if("string"==typeof e)for(n=o.length;n--&&(i=o[n]).id!==e;);else if("string"==typeof t)for(e.element&&!this.isCustomEvent(e.element,t)&&(e=e.element),n=o.length;n--&&((i=o[n]).elem!==e||("string"!=typeof i||i.type!=t)&&-1==i.type.indexOf(t)););else for(n=o.length;n--&&(!((i=o[n]).elem===e||i.elem.element&&i.elem.element===e)||i.callback!==t););if(!(n<0||(o.splice(n,1),i.custom)))switch(r){case"W3C":"string"==typeof i.type?(i.elem.element||i.elem).removeEventListener(i.type,i.fn,!1):i.type.forEach(function(e){(i.elem.element||i.elem).removeEventListener(e,i.fn,!1)});break;case"MS":"string"==typeof i.type?(i.elem.element||i.elem).detachEvent("on"+i.type,i.fn):i.type.forEach(function(e){(i.elem.element||i.elem).detachEvent("on"+e,i.fn)}),delete i.fn}},serve:function(e,t,n){for(var r,i=0;r=o[i++];)r.elem===e&&r.type===t&&r.fn(n)},serveXhr:function(e,t){for(var n,r=0;n=o[r++];)"xhr"===n.elem&&n.type===t&&n.callback.apply(e)},isCustomEvent:function(e,t){var n;return n=(t="on"+t)+(e.tagName||""),void 0===s[n]&&(s[n]=!0,S(e,"setAttribute")&&void 0===e[t]&&(e.setAttribute(t,"return true;"),s[n]=S(e,t))),!s[n]},getAbsMousePos:function(e){return new Coord(e.clientX,e.clientY).add(vxJS.dom.getDocumentScroll())},getMouseButtons:function(e){var t=e.which;return void 0!==t?{left:1==t,right:2==t,middle:3==t}:{left:1&(t=e.button),right:2&t,middle:4&t}},getMousewheelDirection:function(e){return e.detail?e.detail<1?"up":"down":e.wheelDelta>1?"up":"down"},cancelBubbling:function(e){S(e,"stopPropagation")&&e.stopPropagation(),e.cancelBubble=!0},preventDefault:function(e){S(e,"preventDefault")&&e.preventDefault(),e.returnValue=!1}}),vxJS.dom={getBody:function(){return g||(g=b.body&&"object"==typeof b.body?b.body:b.getElementsByTagName("body")[0]||null),g},unitToPixels:(m=document.createElement("div"),p=m.style,v={position:"absolute",border:"none",margin:"0",padding:"0",height:"1px",visibility:"hidden"},Object.keys(v).forEach(function(e){p[e]=v[e]}),function(e){var t,n=this.getBody();return p.width="10"+e,n.appendChild(m),t=m.offsetWidth/10,n.removeChild(m),t}),allowsFixedPosition:function(){if(void 0===h){var e,t="div".create(),n=t.style,r=vxJS.dom.getBody();n.position="fixed",n.top="0px",n.left="0px",r.appendChild(t),e=vxJS.dom.getElementOffset(t),r.removeChild(t),h=!e.x&&!e.y}return h},setOpacity:function(e,t){var n=e.style,r=t>1?1:t<0?0:t;"string"==typeof n.opacity?n.opacity=""+r:"string"==typeof n.filter&&(n.filter="alpha(opacity="+100*r+")")},getOpacity:function(e){var t,n=e.style;return"string"==typeof n.opacity?n.opacity?+n.opacity:1:e.filters&&void 0!==e.filters.Alpha.opacity?e.filters.Alpha.opacity/100:"string"==typeof n.filter&&(t=n.filter.match(/\s*opacity\s*=\s*(\d+)/i))&&t[1]?t[1]/100:1},getStyle:function(t,n){return e.getComputedStyle?e.getComputedStyle(t,"")[n]:!!t.currentStyle&&t.currentStyle[n]},hasClassName:function(e,t){return-1!==(" "+e.className+" ").indexOf(" "+t+" ")},addClassName:function(e,t){e.classList?e.classList.add(t):this.hasClassName(e,t)||(e.className+=(e.className.trim().length?" ":"")+t)},removeClassName:function(e,t){if(e.classList)e.classList.remove(t);else{var n=e.className.split(y.blanks),r=n.indexOf(t);-1!==r&&(n.splice(r,1),e.className=n.join(" "))}},toggleClassName:function(e,t){e.classList?e.classList.toggle(t):this[this.hasClassName(e,t)?"removeClassName":"addClassName"](e,t)},appendChildren:function(e,t){var n;if(y.isNumberOrString.test(typeof t))e.appendChild(document.createTextNode(t));else if(t)if(void 0!==t.length&&void 0===t.nodeName)for(n=0;n<t.length;++n)y.isNumberOrString.test(typeof t[n])?e.appendChild(document.createTextNode(t[n])):t[n]&&e.appendChild(t[n]);else e.appendChild(t);return e},deleteChildNodes:function(e){for(;e.hasChildNodes();)e.removeChild(e.lastChild)},cleanDOM:(f=/\S/,function e(t){var n;if(8===t.nodeType||3===t.nodeType&&!f.test(t.data))t.parentNode.removeChild(t);else if(t.childNodes)for(n=t.childNodes.length;n--;)e(t.childNodes[n])}),walk:function(e,t){for(t(e),e=e.firstChild;e;)this.walk(e,t),e=e.nextSibling},getElementsByClassName:(u={},S(document,"getElementsByClassName")?function(e,t,n){var r=(t||document).getElementsByClassName(e);return n?(n=n.toUpperCase(),Array.prototype.filter.call(r,function(e){return e.nodeName==n})):N(r)}:S(document,"evaluate")?function(e,t,n){var r,o,i=[],a=0;for(o=document.evaluate(".//"+(n||"*").toLowerCase()+"[contains(concat(' ', @class, ' '), ' "+e+" ')]",t||document,function(e){return"html"===e?"http://www.w3.org/1999/xhtml":null},XPathResult.UNORDERED_NODE_SNAPSHOT_TYPE,null);r=o.snapshotItem(a);)i[a++]=r;return i}:function(e,t,n){var r,o,i,a=[],s=0,l=(t||document).getElementsByTagName(n?n.toLowerCase():"*");for(u[e]?o=u[e]:(o=new RegExp("(^|\\s)"+e+"(\\s|$)"),u[e]=o);r=l[s++];)(i=r.className)&&(i==e||o.test(i))&&a.push(r);return a}),getParentElement:function(e,t){var n,r,o;if(!t)return e.parentNode;if(/^[a-z0-9]+$/i.test(t)){for(n=t.toUpperCase();e=e.parentNode;)if(e.nodeName.toUpperCase()===n)return e}else{if(!(r=t.match(/^([a-z0-9]+)([\.#])(\w+)$/i))||r.length<3)return null;for(n=r[1].toUpperCase(),o="."===r[2]?new RegExp("\\b"+r[3]+"\\b"):null;e=e.parentNode;)if(e.nodeName.toUpperCase()===n&&(!o&&e.id===r[3]||o.test(e.className)))return e}return null},getElementOffset:function(e,t){var n,r,o,i,a,s,l=e.ownerDocument,c=this.getBody();if(t||(t=l),e===t)return new Coord(0,0);for(s=typeof(i=e)[a="offsetParent"],o=y.isHM.test(s)&&i[a]?e.offsetParent:null,r=e.parentNode,n=new Coord(e.offsetLeft,e.offsetTop);r&&r!==t;){if(r!==c&&r!==x&&(n.x-=r.scrollLeft||0,n.y-=r.scrollTop||0),r===o&&r!==c&&(n.x+=o.offsetLeft,n.y+=o.offsetTop,o=r.offsetParent),"fixed"===r.style.position){n.y+=c.scrollTop||x.scrollTop,n.x+=c.scrollLeft||x.scrollLeft;break}r=r.parentNode}return n},getElementPosition:function(e){return new Coord(parseInt(this.getStyle(e,"left"),10),parseInt(this.getStyle(e,"top"),10))},setElementPosition:function(e,t){var n=e.style;n.left=t.x+"px",n.top=t.y+"px"},getElementSize:function(e){return new Coord(e.offsetWidth,e.offsetHeight)},getElementStyleSize:function(e){var t=e.style,n=t.width,r=t.height,o=this.getElementSize(e),i=new Coord(o.x,o.y);return t.height=o.y+"px",i.y-=e.offsetHeight-o.y,t.height=r,t.width=o.x+"px",i.x-=e.offsetWidth-o.x,t.width=n,i},setElementSize:function(e,t){var n=e.style;n.width=t.x+"px",n.height=t.y+"px"},nextSameNodeNameSibling:function(e){for(var t=e.nodeName;e=e.nextSibling;)if(e.nodeName===t)return e},prevSameNodeNameSibling:function(e){for(var t=e.nodeName;e=e.previousSibling;)if(e.nodeName===t)return e},moveBefore:function(e,t){var n=e.parentNode;n.removeChild(e),n.insertBefore(e,t)},moveAfter:function(e,t){var n=e.parentNode;n.removeChild(e),n.insertBefore(e,t?t.nextSibling:null)},concatText:function(e){var t,n,r="",o=e.childNodes;for(t=0;t<o.length;t++)switch(o[t].nodeType){case 1:if("INPUT"===(e=o[t].nodeName.toUpperCase())&&"text"===o[t].type)r+=o[t].value;else{if("SELECT"===e&&"select-one"===o[t].type&&o[t].options&&o[t].selectedIndex>=0&&o[t].options[o[t].selectedIndex]){r+=this.concatText(o[t].options[o[t].selectedIndex]);break}if("SELECT"===e&&"select-multiple"===o[t].type&&o[t].options)for(n=o[t].options.length;n--;)r+=o[t].options[n].selected?this.concatText(o[t].options[n]):"";else r+="IMG"===e?o[t].title?o[t].title:o[t].alt?o[t].alt:o[t].src:this.concatText(o[t])}break;case 3:r+=o[t].nodeValue}return r},parse:function(e){var t,n,r=document.createDocumentFragment(),o=function(e,t){var n,r,i,a,s=e.properties;if(!e.node){if(e.text)return void t.appendChild(document.createTextNode(e.text));if(e.html){for((a=document.createElement("div")).innerHTML=e.html;a.firstChild;)t.appendChild(a.firstChild);return}return e.fragment?void t.appendChild(e.fragment):void 0}if(i=document.createElement(e.node),"object"==typeof s)for(n in s)s.hasOwnProperty(n)&&("text"===n?i.appendChild(document.createTextNode(s[n])):i[n]=s[n]);if(e.childnodes&&(r=e.childnodes.length))for(n=0;n<r;n++)o(e.childnodes[n],i);t.appendChild(i)};if(Array.isArray(e))for(t=0,n=e.length;t<n;++t)o(e[t],r);else o(e,r);return r},getViewportSize:function(){var e=this.getBody();if(d)return d();var t="string"==typeof b.compatMode?function(){return x&&-1!==b.compatMode.toLowerCase().indexOf("css")?x:e}:function(){return x&&0!==x.clientWidth?x:e};if(x)var n=function(){var t,n={compatMode:b.compatMode},r=x.clientHeight,o=e.clientHeight,i=b.createElement("div");if(i.style.height="100px",e.appendChild(i),n.body=!r||r!=x.clientHeight,n.html=o!=e.clientHeight,e.removeChild(i),n.body||n.html&&n.body!=n.html)return"number"==typeof e.clientTop&&e.clientTop&&x.clientWidth&&(t=e.style.borderWidth,e.style.borderWidth="0px",n.includeBordersInBody=e.clientHeight!=o,e.style.borderWidth=t),n}();return"number"==typeof b.clientWidth?d=function(){return new Coord(b.clientWidth,b.clientHeight)}:x&&"number"==typeof x.clientWidth?d=function(){var r,o,i=t();return n&&(i=n.body?e:x),r=i.clientHeight,o=i.clientWidth,n&&n.body&&n.includeBordersInBody&&(r+=2*e.clientTop,o+=2*e.clientLeft),new Coord(o,r)}:"number"==typeof window.innerWidth&&(d=function(){return new Coord(window.innerWidth,window.innerHeight)}),d?d():void 0},getDocumentScroll:function(){return"number"==typeof e.pageXOffset?this.getDocumentScroll=function(){return new Coord(e.pageXOffset,e.pageYOffset)}:this.getDocumentScroll=function(){return new Coord(Math.max(vxJS.dom.getBody().scrollLeft,x.scrollLeft),Math.max(vxJS.dom.getBody().scrollTop,x.scrollTop))},this.getDocumentScroll()}},vxJS.selection={getSelection:S(e,"getSelection")?function(){return e.getSelection()}:S(b,"selection")?function(){return b.selection}:void 0,set:function(e,t,n){var r;t=t||0,void 0===n&&(n=e.value.length-t),S(e,"setSelectionRange")?e.setSelectionRange(t,t+n):S(e,"createTextRange")&&((r=e.createTextRange()).moveStart("character",t),r.moveEnd("character",t+n-e.value.length),r.select()),e.focus()},get:function(e){var t,n;return void 0!==e.selectionStart?e.value.substring(e.selectionStart,e.selectionEnd):(n=this.getSelection())&&S(n,"createRange")?(t=n.createRange()).parentElement==e?t.text:void 0:""},getCaretPosition:function(e){var t,n,r,o;return void 0!==e.selectionStart?e.selectionStart:(t=this.getSelection())&&S(t,"createRange")?(e.focus(),n=t.createRange(),o=(r=e.createTextRange()).duplicate(),r.moveToBookmark(n.getBookmark()),o.setEndPoint("EndToStart",r),o.text.length):void 0},setCaretPosition:function(e,t){"end"===t?this.set(e,e.value.length):this.set(e,+t||0,0)}},vxJS.cookie={getItem:function(e){return decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))||null},setItem:function(e,t,n,r,o,i){var a="";if(!e||/^(?:expires|max\-age|path|domain|secure)$/i.test(e))return!1;if(n)switch(n.constructor){case Number:a=n===1/0?"; expires=Fri, 31 Dec 9999 23:59:59 GMT":"; max-age="+n;break;case String:a="; expires="+n;break;case Date:a="; expires="+n.toUTCString()}return document.cookie=encodeURIComponent(e)+"="+encodeURIComponent(t)+a+(o?"; domain="+o:"")+(r?"; path="+r:"")+(i?"; secure":""),!0},removeItem:function(e,t,n){return!(!e||!this.hasItem(e))&&(document.cookie=encodeURIComponent(e)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT"+(n?"; domain="+n:"")+(t?"; path="+t:""),!0)},hasItem:function(e){return new RegExp("(?:^|;\\s*)"+encodeURIComponent(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=").test(document.cookie)}},vxJS.isHostMethod=S,vxJS.hasHostMethods=w,vxJS.isEmpty=function(e){var t;if("object"!=typeof e)return!0;for(t in e)if(e.hasOwnProperty(t))return!1;return!0},vxJS.merge=C,vxJS.collectionToArray=N,vxJS.widget={}}(this),vxJS.xhr=function(e,t,n,r){e||(e={}),t||(t={}),n||(n={});var o,i,a=e.timeout||5e3,s={},l=new XMLHttpRequest,c={response:{}},d=function(){n.node&&vxJS.dom.removeClassName(n.node,"loading"),o&&window.clearTimeout(o),l&&(l.onreadystatechange=function(){},0!==l.readyState&&4!==l.readyState&&l.abort()),i=!1},u=function(){4===l.readyState&&(d(),l.status>=200&&l.status<300||1223===l.status?(e.forcePlainTextResponse?c.response=l.responseText:e.forceXMLResponse?c.response=l.responseXML||l.responseText:c.response=JSON.parse(l.responseText||"{}"),r&&"function"==typeof r.complete&&r.complete.call(c),vxJS.event.serve(c,"complete"),vxJS.event.serveXhr(c,"complete")):(r&&"function"==typeof r.fail&&r.fail.call(c),vxJS.event.serve(c,"fail"),vxJS.event.serveXhr(c,"fail")))},f=function(e,t){s[e]=t},h=function(e,t){var n,r,o=[];if(!0===t)return encodeURIComponent(e)+"=1";if(!1===t)return encodeURIComponent(e)+"=0";if(Array.isArray(t))return r=0,t.forEach(function(t){o.push(h(e+"["+r+++"]",t))}),o.join("&");if("object"==typeof t){for(n in t)t.hasOwnProperty(n)&&o.push(h(e+"["+n+"]",t[n]));return o.join("&")}return encodeURIComponent(e)+"="+encodeURIComponent(t)},m=function(e){var t,n=[];for(t in e)e.hasOwnProperty(t)&&n.push(h(t,e[t]));return n.join("&")};return c.setHeader=function(e,t){return f(e,t),this},c.setHeaders=function(e){for(var t=0,n=Object.keys(e);t<n.length;++t)f(n[t],e[n[t]]);return this},c.use=function(o,i,a,s){return o&&(e=vxJS.merge(e,o)),i&&(t=i),a&&(n=a),s&&(r=s),this},c.getRequestParameters=function(){return e},c.getParameters=function(){return t},c.getAnimationParameters=function(){return n},c.getCallbacks=function(){return r},c.isActive=function(){return i},c.xhrObj=l,c.abort=d,c.submit=function(){var h,p,v,g=window.location,y=encodeURI(e.uri||(g.hash?g.href.substring(0,g.href.indexOf(g.hash)):g.href));for(d(),vxJS.event.serve(c,"beforeSend"),e.command&&((t.formData||t).httpRequest=e.command),e.echo&&(t.echo=1),f("X-Requested-With","XMLHttpRequest"),e.forceXMLResponse&&l.overrideMimeType&&l.overrideMimeType("text/xml"),e.method&&"GET"==e.method.toUpperCase()?(l.open("GET",y+(-1!==y.indexOf("?")?"&":"?")+(new Date).getTime()+"&"+(e.useJsonSerialization?"xmlHttpRequest="+encodeURIComponent(JSON.stringify(t)):m(t)),!0),v=null):(l.open("POST",y,!0),e.raw?v=t:(f("Content-Type","application/x-www-form-urlencoded"),v=e.useJsonSerialization?"xmlHttpRequest="+encodeURIComponent(JSON.stringify(t)):m(t))),h=0,p=Object.keys(s);h<p.length;++h)l.setRequestHeader(p[h],s[p[h]]);l.onreadystatechange=u,l.send(v),i=!0,a>0&&(o=window.setTimeout(function(){d(),r&&"function"==typeof r.timeout&&r.timeout.call(c),vxJS.event.serve(c,"timeout"),vxJS.event.serveXhr(c,"timeout")},a)),n.node&&vxJS.dom.addClassName(n.node,"loading")},c},vxJS.widget.xhrForm=function(e,t,n){if(!e.nodeName||"form"!==e.nodeName.toLowerCase())throw new Error("widget.xhrForm: no form element specified!");n||(n={});for(var r,o,i,a,s,l,c,d=[],u=[],f={},h=vxJS.xhr(t||{}),m=[],p=function(e){var t,n=new FileReader,r=[];n.addEventListener("load",function(){r[t].arrayBuffer=n.result,r[++t]&&n.readAsArrayBuffer(r[t].file)});var o=function(){if(n.readyState===FileReader.LOADING&&n.abort(),r=[],e.files.length){for(var o=0;o<e.files.length;++o)r.push({file:e.files[o],arrayBuffer:null});t=0,n.readAsArrayBuffer(r[0].file)}};return e.value&&o(),e.addEventListener("change",o),{getFiles:function(){return r},getInput:function(){return e}}},v=e.querySelectorAll("input[type=file]"),g=0;g<v.length;++g)m.push(p(v[g]));var y=function(){s=!0},b=function(){s=!1},x=function(t){for(var n,r,o,i,a=t.length;a--;)if(r=e.elements[t[a].name])if(n=t[a].value,r instanceof NodeList&&Array.isArray(n)&&r.length===n.length)switch(r.item(0).type){case"radio":case"checkbox":for(o=0;o<n.length;++o)r[o].checked=!!n[o];break;case"select-multiple":for(o=0;o<n.length;++o)if(Array.isArray(n[o]))for(i=r[o].options.length;i--;)r[o].options[i].selected=-1!==n[o].indexOf(r[o].options[i].value);break;default:for(o=0;o<n.length;++o)r[o].value=n[o]||""}else if(r instanceof Node)switch(r.type){case"radio":case"checkbox":r.checked=!!n;break;case"select-multiple":if(Array.isArray(n))for(i=r.options.length;i--;)r.options[i].selected=-1!==n.indexOf(r.options[i].value);break;default:r.value=n||""}},S=function(){d.forEach(function(e){var t;e.elements.forEach(function(e){vxJS.dom.removeClassName(e,"error")}),(t=document.getElementById("error_"+e.name))&&(vxJS.dom.removeClassName(t,"error"),e.text&&t.lastChild&&t.removeChild(t.lastChild))}),d=[]},w=function(e,t){var r,o,i,a,s,l,c,d,u,f={},h=/^(.*?)\[(.*?)\]$/;for(o=0;o<e.length;++o)if(i=null,d=null,l=(r=e[o]).name,n.namesToHashes&&(d=l.match(h))&&(l=d[1],c=d[2],i={}),r.type&&!r.disabled){switch(r.type){case"radio":case"checkbox":r.checked&&(c?i[c]=r.value:i=r.value);break;case"select-multiple":if(vxJS.dom.hasClassName(r,"vxJS_dualSelectBox_source"))continue;for(u=[],a=(s=r.options).length;a--;)(s[a].selected||vxJS.dom.hasClassName(r,"vxJS_dualSelectBox_dest"))&&u.push(s[a].value);c?i[c]=u:i=u;break;case"select-one":c?i[c]=r.options[r.selectedIndex].value:i=r.options[r.selectedIndex].value;break;case"submit":case"image":case"button":t&&r===t&&(i=r.value);break;case"file":break;default:d?i[c]=r.value:i=r.value}if(null===i||"object"==typeof i&&!Object.keys(i).length)continue;void 0===f[l]?f[l]=d?[i]:i:c?f[l][c]=i[c]:(Array.isArray(f[l])||(f[l]=[f[l]]),f[l].push(i))}return f},C=function(e){for(var t=u.length;t--;)if(e===u[t].id)return u[t].container},N=function(){a&&vxJS.dom.addClassName(a,"loading"),!0,y(),e.submit()},J=function(t){var n,r,o,i,a,s,l,h=[],m=[],p=null;if(t||(t=this.response),vxJS.event.serve(f,"beforeResponseCheck",t),u.forEach(function(e){vxJS.dom.deleteChildNodes(e.container)}),S(),b(),s=t.response&&t.echo?t.response:t){if(a=s.command){if("redirect"===a&&s.location)return void(window.location.href=s.location);if("submit"===a)return void N()}if(s.elements){for(n=s.elements.length;n--;)(r=s.elements[n]).value&&h.push({name:r.name,value:r.value}),r.error&&("object"==typeof r.error&&(p=[],Object.keys(r.error).forEach(function(e){r.error[e]&&(p[e]=!0)})),m.push({name:r.name,text:r.errorText||null,ndx:p}));x(h),(l=m).forEach(function(t){var n,r=e.elements[t.name];r?r.nodeName?(t.elements=[r],vxJS.dom.addClassName(r,"error")):(t.elements=vxJS.collectionToArray(r),t.elements.forEach(function(e,n){t.ndx&&!t.ndx[n]||vxJS.dom.addClassName(e,"error")})):t.elements=[],(n=document.getElementById("error_"+t.name))&&(vxJS.dom.addClassName(n,"error"),t.text&&n.appendChild(document.createTextNode(t.text)))}),d=l}if(o=s.msgBoxes)for(n=o.length;n--;)o[n].id&&(i=C(o[n].id))&&i.appendChild(vxJS.dom.parse(o[n].elements))}c=t,vxJS.event.serve(f,"check",t)};return f.addSubmit=function(t){return vxJS.event.addListener(t,"click",function(t){vxJS.event.preventDefault(t),function(t){var n,c,d,u,p,v,g,b,x,S,C,N="vxJS-xhrForm-boundary";if(!s)if(a=t,vxJS.event.serve(f,"beforeSubmit"),l)l=!1;else if(y(),o)J({command:"submit"});else{if(n=w(e.elements,t),vxJS.merge(n,r),m.length){for(c in h.setHeader("Content-Type","multipart/form-data; boundary="+N),v=[],h.getRequestParameters().command&&v.push({name:"httpRequest",value:h.getRequestParameters().command}),h.getRequestParameters().echo&&v.push({name:"echo",value:h.getRequestParameters().echo}),n)if(n.hasOwnProperty(c))if(Array.isArray(n[c]))for(d=0,u=n[c].length;c<u;++d)v.push({name:key+"["+d+"]",value:n[c][d]});else v.push({name:c,value:n[c]});for(g=[],b="",c=0;c<v.length;++c)b+="--"+N+"\r\n",b+='content-disposition: form-data; name="'+v[c].name+'"\r\n\r\n'+v[c].value+"\r\n";for(g.push(b),c=0;c<m.length;++c)for(p=m[c].getFiles(),d=0;d<p.length;++d)b="--"+N+"\r\n",b+='content-disposition: form-data; name="'+m[c].getInput().name+'"; ',b+='filename="'+p[d].file.name+'"\r\n',b+="content-type: "+p[d].file.type+"\r\n\r\n",g.push(b,new Uint8Array(p[d].arrayBuffer),"\r\n");for(g.push("--"+N+"--"),u=0,c=g.length;c--;)u+=g[c].length;for(S=new Uint8Array(u),C=0,c=0;c<g.length;++c)if(g[c]instanceof Uint8Array)S.set(g[c],C),C+=g[c].length;else{for(x=new Uint8Array(g[c].length),d=0,u=g[c].length;d<u;++d)x[d]=g[c].charCodeAt(d);S.set(x,C),C+=u}h.use({raw:!0},S,{node:a})}else h.use(null,n,{node:a});h.submit(),i=n}}(this)}),this},f.addMessageBox=function(e,t){return u.push({container:e,id:t||"MsgBox"+u.length}),this},f.clearErrors=function(){return S(),this},f.getErrors=function(){return d},f.clearFileInputs=function(){var t,n=e.getElementsByTagName("input");if(n&&(t=n.length)){for(;--t;)"file"===n[t].type&&n[t].parentNode.replaceChild("input".setProp([["type","file"],["name",n[t].name]]).create(),n[t]);return this}},f.forceRequest=function(){var t;if(vxJS.event.serve(f,"beforeSubmit"),!l)return y(),t=w(e.elements,this),vxJS.merge(t,r),h.use(null,t,{node:a||null}).submit(),i=t,this;l=!1},f.disableImmediateSubmit=function(){return o=!1,this},f.enableImmediateSubmit=function(){return o=!0,this},f.setValues=function(e){for(var t=Object.keys(e),n=t.length,r=[];n--;)r.push({name:t[n],value:e[t[n]]});return x(r),this},f.getSubmittedValues=function(){return i},f.getLastXhrResponse=function(){return c},f.setPayload=function(e){return r=e,this},f.getPayload=function(){return r},f.clearPayload=function(){return r=null,this},f.isSubmittingNow=function(){return s},f.cancelSubmission=function(){l=!0},f.getUploads=function(){return m},vxJS.event.addListener(h,"complete",J),vxJS.event.addListener(h,"fail",b),vxJS.event.addListener(h,"timeout",b),f.element=e,f.submit=N,f.xhr=h,f},vxJS.widget.calendar=function(e,t){"object"!=typeof t&&(t={});var n,r,o,i,a,s,l,c,d,u,f=t.alignTo||e,h={},m=new Date,p=new Date(m.getFullYear(),m.getMonth(),m.getDate()),v=t.initDate&&t.initDate.constructor===Date?t.initDate:null,g=t.inputLocale||"date_de",y=t.outputFormat||("date_de"===g?"%D.%M.%Y":"%Y-%M-%D"),b=(t.months||"Jan Feb MÃ¤rz Apr Mai Juni Juli Aug Sept Okt Nov Dez").split(" "),x=t.showCw;t.noPast&&(d=t.noPast.constructor===Date?t.noPast:p),t.noFuture&&(u=t.noFuture.constructor===Date?t.noFuture:p);var S=function(){var t=e.value.trim();return/^\d\d?[ \/\-.]+(?:\d{2}|\d{4})$/.test(t)?function(e,t,n){t=t||(new Date).getFullYear();var r=7*(e-1)+1,o=new Date(t,0,1).getDay()||7;return new Date(t,0,r-o+(o>4?8:1))}((t=t.split(/[ \/\-.]+/))[0],(""+(v||p).getFullYear()).slice(0,4-t[1].length)+t[1]):(t=t.toDateTime(g,!0))?t:void 0},w=function(e){e&&e.constructor===Date||(e=new Date),c?(c.setMonth(e.getMonth()),c.setFullYear(e.getFullYear())):c=new Date(e.getFullYear(),e.getMonth(),1)},C=function(){var e,r,a,s,f,h,m="div".setProp("class","calendar-body").create(),y=c.getMonth(),S=c.getFullYear(),w=new Date(S,y+1,0),C=w.getDate(),N=new Date(S,y,"date_us"===g?1:0).getDay(),J=(("date_us"===g?6:7)-w.getDay())%7,T=new Date(S,y,1-N);for(t.yearSelect?(o.innerHTML=b[y],i.innerHTML=S):o.innerHTML=b[y]+" "+S,l=[],r=1-N;r<=C+J;++r)a=["calendar-date"],h=new Date(S,y,r),(d&&d>h||u&&u<h)&&a.push("disabled"),r<1?a.push("prev-month"):r>C?a.push("next-month"):a.push("current-month"),-1===a.indexOf("disabled")?(f="button".setProp("class","date-item").create(h.getDate()),l[r+N-1]={date:h,elem:f,disabled:-1!==a.indexOf("disabled")}):f="span".setProp("class","date-item").create(h.getDate()),h.toString()===p.toString()&&f.classList.add("date-today"),v&&h.toString()===v.toString()&&f.classList.add("active"),m.appendChild("div".setProp("class",a.join(" ")).create(f));if(x)for(s=0,e=T.getCW("date_us"===g);m.childNodes[s];)e>52&&(e=l[7*r].date.getCW("date_us"===g)),m.insertBefore("div".setProp("class","calendar-date cw disabled").create("span".setProp("class","date-item").create(e++)),m.childNodes[s]),s+=8;n.querySelector(".calendar-container").replaceChild(m,n.querySelector(".calendar-container").lastChild)},N=function(){var t,o,i,a,s,l,c;r||(e&&(t=S())&&(v=t),w(v),C(),f&&(a=vxJS.dom.getElementOffset(f),s=vxJS.dom.getElementSize(f),l=vxJS.dom.getDocumentScroll(),(c=n.style).visibility="hidden",c.display="",o=vxJS.dom.getElementSize(n),c.display="none",c.visibility="visible",i=a.y+s.y+o.y>vxJS.dom.getViewportSize().y+l.y&&a.y-o.y>l.y?a.y-o.y:a.y+s.y,vxJS.dom.setElementPosition(n,new Coord(a.x,i))),n.style.display="",r=!0,vxJS.event.serve(h,"showWidget"))},J=function(){r&&(n.style.display="none",r=!1,vxJS.event.serve(h,"hideWidget"))},T=function(t){e&&e.disabled||(vxJS.event.cancelBubbling(t),vxJS.event.removeListener(a),s=vxJS.event.addListener(document,"click",E),N())};if(function(){var r,a,s,d;switch(o="div".setProp("class","month navbar-primary").create(),a=["button".setProp("class","btn btn-action btn-link btn-large prvMon").create(),o,"button".setProp("class","btn btn-action btn-link btn-large nxtMon").create()],s="div".setProp("class","calendar-container").create(["div".setProp("class","calendar-header").create(),"div".setProp("class","calendar-body").create()]),t.yearSelect&&(i="div".setProp("class","year navbar-primary").create(),a.push("button".setProp("class","btn btn-action btn-link btn-large prvYear").create(),i,"button".setProp("class","btn btn-action btn-link btn-large nxtYear").create())),n="div".setProp("class",t.skinClass||"calendar"+(t.showCw?" cw":"")).create(["div".setProp("class","calendar-nav navbar").create(a),s]),g){case"date_us":r="CW,S,M,T,W,T,F,S";break;case"date_iso":r="CW,M,T,W,T,F,S,S";break;default:r="KW,M,D,M,D,F,S,S"}r=r.split(","),x||r.shift();for(var u=0;u<r.length;++u)s.firstChild.appendChild("div".setProp("class","calendar-date").create(r[u]));vxJS.event.addListener(n,"click",function(n){var r,o,i=this.classList;if(vxJS.event.cancelBubbling(n),"button"===this.nodeName.toLowerCase()){if(i.contains("prvMon"))c.setMonth(c.getMonth()-1),C(),r="monthChange";else if(i.contains("nxtMon"))c.setMonth(c.getMonth()+1),C(),r="monthChange";else if(i.contains("prvYear"))c.setFullYear(c.getFullYear()-1),C(),r="yearChange";else if(i.contains("nxtYear"))c.setFullYear(c.getFullYear()+1),C(),r="yearChange";else for(var a=l.length;a--;)if(l[a].elem===this){r="datePick",o=l[a].date,t.dontHide&&((d=s.querySelector(".active"))&&vxJS.dom.removeClassName(d,"active"),vxJS.dom.addClassName(this.parentNode,"active"));break}r&&("datePick"===r&&(v=o,e&&(e.value=o.format(y)),E()),vxJS.event.serve(h,r))}}),t.dontHide||(n.style.display="none",n.style.position="absolute",document.body.appendChild(n))}(),t.trigger&&!t.dontHide){a=vxJS.event.addListener(t.trigger,t.eType||"click",T);var E=function(){vxJS.event.removeListener(s),a=vxJS.event.addListener(t.trigger,t.eType||"click",T),J()}}else e?(v||(v=S()),w(v)):w(),C(),E=function(){J()};return e&&vxJS.event.addListener(e,"keydown",function(e){var n,r=e.keyCode;13===r&&t.dontHide&&(n=S(),v&&n.toString()===v.toString()||(v=n,w(n),C())),-1!==[9,13,27].indexOf(r)&&E()}),h.element=n,h.show=N,h.hide=J,h.getDate=function(){return v},h.setDate=function(e){e&&e.constructor===Date&&!isNaN(e)&&(v=e,w(e),C())},h.clearDate=function(){v=null,w(p),C()},h},vxJS.widget.sorTable=function(e,t){t||(t={});var n,r,o,i,a,s,l,c,d=t.columnFormat&&t.columnFormat.length?t.columnFormat:[],u=[],f=[],h=[],m={},p={},v=function(e){var t,n,r=vxJS.event.getAbsMousePos(e),o=a.pos.y,i=a.elem;if(r.y<o&&(t=vxJS.dom.prevSameNodeNameSibling(i))&&r.y<(o-=t.offsetHeight/2)){for(;(n=vxJS.dom.prevSameNodeNameSibling(t))&&!(r.y>o-t.offsetHeight/2-n.offsetHeight/2);)o-=t.offsetHeight,t=n;if(p==t)return;b(),p.above=t,vxJS.dom.addClassName(t,"insertAbove")}else if(r.y>(o+=i.offsetHeight)&&(t=vxJS.dom.nextSameNodeNameSibling(i))&&r.y>(o+=t.offsetHeight/2)){for(;(n=vxJS.dom.nextSameNodeNameSibling(t))&&!(r.y<o+t.offsetHeight/2+n.offsetHeight/2);)o+=t.offsetHeight,t=n;if(p==t)return;b(),p.below=t,vxJS.dom.addClassName(t,"insertBelow")}else b();vxJS.event.preventDefault(e)},g=function(){vxJS.event.removeListener(s),vxJS.event.removeListener(l),p.above?p.above.parentNode.insertBefore(a.elem,p.above):p.below&&p.below.parentNode.insertBefore(a.elem,p.below.nextSibling),(p.below||p.above)&&(S(i),i=null),vxJS.event.serve(m,"dragStop"),vxJS.dom.removeClassName(a.elem,"dragged"),b(),a=null},y=function(e){for(var t=this;t&&t.parentNode.parentNode!=r;)t=t.parentNode;t&&"manual"===f[t.cellIndex].format&&(l=vxJS.event.addListener(document,"mousemove",v),s=vxJS.event.addListener(document,"mouseup",g),a={elem:t.parentNode,pos:vxJS.dom.getElementOffset(t.parentNode)},vxJS.dom.addClassName(a.elem,"dragged"),vxJS.event.serve(m,"dragStart"),vxJS.event.preventDefault(e))},b=function(){p.above?(vxJS.dom.removeClassName(p.above,"insertAbove"),p.above=null):p.below&&(vxJS.dom.removeClassName(p.below,"insertBelow"),p.below=null)},x=function(e){var t=u.length;if(e)for(vxJS.dom.removeClassName(e.elem,e.asc?"desc":"asc"),vxJS.dom.addClassName(e.elem,e.asc?"asc":"desc");t--;)vxJS.dom.addClassName(u[t].cells[e.ndx],"active")},S=function(e){var t=u.length;if(e)for(vxJS.dom.removeClassName(e.elem,e.asc?"asc":"desc");t--;)vxJS.dom.removeClassName(u[t].cells[e.ndx],"active")},w=function(){i&&(vxJS.event.serve(m,"beginSort"),function(e){var t=document.createDocumentFragment(),n=0;for(u=[];e[n];)u[n]=e[n].element,t.appendChild(u[n++]);r.appendChild(t)}(function(e){var t,n=u.length,r=f[e].format,o=[],i={float:function(e){return/^[+\-]?(?:\d{1,3}(?:[ ,\x27]\d{3})+|\d+)(?:\.\d+)?$/.test(e)?e.replace(/[^0-9.\-]/g,""):e},float_comma:function(e){return/^[+\-]?(?:\d{1,3}(?:[ .\x27]\d{3})+|\d+)(?:,\d+)?$/.test(e)?e.replace(/[^0-9,\-]/g,"").replace(",","."):e},date:function(e,t){var n=e.toDateTime(t,!0);return n?n.format("%Y-%M-%D"):e},time:function(e,t){return e.toDateTime(t)}};if(r&&/^(date_|time_)[a-z]+$/.test(r)&&(r=r.split("_")[0]),r&&"function"!=typeof r)for(;n--;)t=u[n],o[n]={element:t,value:i[r](vxJS.dom.concatText(u[n].cells[e]),f[e].format)};else for(;n--;)t=u[n],o[n]={element:t,value:vxJS.dom.concatText(t.cells[e]).toLowerCase()};return o}(i.ndx).sort("function"==typeof i.format?i.format.bind(i):function(){var e=this.asc?1:-1;return/^(?:float|float_comma)$/.test(this.format)?function(t,n){return t=parseFloat(t.value),isNaN(t)?1:(n=parseFloat(n.value),isNaN(n)?-1:(t-n)*e)}:function(t,n){return t.value===n.value?0:t.value<n.value?-e:e}}.bind(i)())),vxJS.event.serve(m,"finishSort"))},C=function(){for(var e,t,n=this;!/th|td/i.test(n.nodeName)&&n.parentNode;)n=n.parentNode;void 0!==(t=n.cellIndex)&&(e=f[t],/^no_sort|manual$/.test(e.format)||(S(i),e===i?e.asc=!e.asc:i=e,x(e),w()))};return m.getActiveColumn=function(){return i},m.initSort=function(){u=vxJS.collectionToArray(r.rows),h=[].concat(u),i&&x(i)},m.getCurrentOrder=function(){var e,t=u.length,n=[];for(e=0;e<t;++e)n.push(h.indexOf(r.rows[e]));return n},m.insertRow=function(e,t){(+t>u.length||void 0===t)&&(t=u.length),h.splice(t,0,e),u.splice(t,0,e),r.insertBefore(e,u[t+1]||null),i&&vxJS.dom.addClassName(e.cells[i.ndx],"active")},m.removeRow=function(e){h.splice(h.indexOf(e),1),u.splice(u.indexOf(e),1),r.removeChild(e)},m.replaceRow=function(e,t){h.splice(h.indexOf(t),1,e),u.splice(u.indexOf(t),1,e),r.replaceChild(e,t),i&&vxJS.dom.addClassName(e.cells[i.ndx],"active")},m.removeAllRows=function(){var e;for(h=[],u=[];e=r.lastChild;)r.removeChild(e)},m.updateRow=function(e,t){Array.isArray(t)&&(e.nodeName&&"tr"!=!e.nodeName.toLowerCase()||(e=u[+ndx]),t.forEach(function(t,n){var r=e.cells[n];null!==t&&(vxJS.dom.deleteChildNodes(r),t.nodeType?r.appendChild(t):r.appendChild(document.createTextNode(t)))}))},m.sortBy=function(e,t){var n=f[e];/^no_sort|manual$/.test(n.format)||(n.asc=!t||"asc"==t.toLowerCase(),n!==i&&(S(i),i=n),x(n),w())},m.enableSort=function(){c||(c=vxJS.event.addListener(n.rows[void 0===t.activeHeaderRowIndex?n.rows.length-1:t.activeHeaderRowIndex],"click",C),vxJS.dom.removeClassName(n,"disabled"))},m.disableSort=function(){c&&(vxJS.event.removeListener(c),vxJS.dom.addClassName(n,"disabled"),c=null)},m.getDraggedRow=function(){return a.elem},m.reSort=w,function(){var i,a;if("tbody"===e.nodeName.toLowerCase())e=(r=e).parentNode;else{if("table"!==e.nodeName.toLowerCase())throw new Error("vxJS.widget.sorTable: No valid table or tbody element.");r=e.tBodies[0]}if(!(n=e.getElementsByTagName("thead")[0])&&!r)throw new Error("vxJS.widget.sorTable: neither tbody nor thead element found.");for(n||(n="thead".create(),r.parentNode.insertBefore(n,r),n.appendChild(r.rows[0])),r||(r="tbody".create(),n.parentNode.appendChild(r)),a=void 0===t.activeHeaderRowIndex?n.rows.length-1:t.activeHeaderRowIndex,o=n.rows[a].cells.length,-1!==d.indexOf("manual")&&vxJS.event.addListener(r,"mousedown",y),i=0;i<o;++i)f.push({ndx:i,elem:n.rows[a].cells[i],format:d[i],asc:!0});m.initSort(),m.enableSort()}(),m.element=r,m},vxJS.widget.simpleTabs=function(){var e={},t=[],n=vxJS.hasHostMethods(window.history,["pushState","replaceState"]),r=function(e,t,n,r){this.tabBar=e,this.label=t.trim(),this.page=n,this.id=r,this.render()};r.prototype={render:function(){var t,n,r,o,i,a=e.tabWrap,s=e.shortenLabelsTo&&this.label.length>e.shortenLabelsTo?(o=this.label,i=e.shortenLabelsTo,o.slice(0,Math.ceil(i/2))+"..."+o.slice(-Math.floor(i/2))):this.label,l=e.shortenLabelsTo&&this.label.length>e.shortenLabelsTo?this.label:"";if(n=this.id?"a".setProp("href",e.setHash?"#"+this.id:"").create(s):document.createTextNode(s),t="li".setProp({title:l,class:"tab-item"}).create(),a)if("string"==typeof a)t.appendChild(a.create(n));else{for(r=a.length;r--;)n=a[r].create(n);t.appendChild(n)}else t.appendChild(n);return this.element=t,this},focus:function(){var e=this.element.getElementsByTagName("a");return e&&e[0]&&e[0].focus(),this},show:function(){return this.visibilty=!0,vxJS.dom.addClassName(this.element,"active"),this.page.style.display="",this},hide:function(){return this.visibilty=!1,vxJS.dom.removeClassName(this.element,"active"),this.page.style.display="none",this},disable:function(){return this.disabled=!0,vxJS.dom.addClassName(this.element,"disabled"),this},enable:function(){return this.disabled=!1,vxJS.dom.removeClassName(this.element,"disabled"),this},isDisabled:function(){return!!this.disabled}};var o=function(e){this.tabs=[],this.container=e};return o.prototype={enable:function(){return this.inactive=!1,vxJS.dom.removeClassName(this.element,"disabled"),this},disable:function(){return this.inactive=!0,vxJS.dom.addClassName(this.element,"disabled"),this},getTabByElement:function(e){for(var t=this.tabs.length;t--;)if(this.tabs[t].element===e)return this.tabs[t]},getTabByNdx:function(e){return this.tabs[e]},getTabById:function(e){for(var t=this.tabs.length;t--;)if(this.tabs[t].id===e)return this.tabs[t]},getTabNdx:function(e){for(var t=this.tabs.length;t--;)if(this.tabs[t]===e)return t},gotoTab:function(t,r){var o=this.last;if(t&&-1!==this.tabs.indexOf(t)&&o!==t)return o.hide(),t.show(),this.last=t,r&&t.id&&e.setHash&&(n?window.history.pushState(t.id,"","#"+t.id):window.location="#"+t.id),this},gotoPrevTab:function(e){return this.gotoTab(this.last.prevTab,e)},gotoNextTab:function(e){return this.gotoTab(this.last.nextTab,e)},focus:function(e,t){return this.gotoTab(e,t),e.focus(),this},getLast:function(){return this.last},insertTab:function(e,t){var n,o=new r(this,e.label,e.page,e.id);return o.hide(),t?((n=t.prevTab)&&(n.nextTab=o),t.prevTab=o,o.prevTab=n,o.nextTab=t,this.tabs.splice(this.getTabNdx(t),0,o),this.container.insertBefore(e.page,t.page),this.ulElement.insertBefore(o.element,t.element)):((n=this.tabs[this.tabs.length-1]).nextTab=o,o.nextTab=null,o.prevTab=n,this.tabs.push(o),this.container.insertBefore(e.page,n.page.nextSibling),this.ulElement.insertBefore(o.element,n.element.nextSibling)),this},removeTab:function(e){var t=this.getTabNdx(e);return e.prevTab&&(e.prevTab.nextTab=e.nextTab),e.nextTab&&(e.nextTab.prevTab=e.prevTab),this.container.removeChild(e.page),this.ulElement.removeChild(e.element),this.tabs.splice(t,1),this}},n&&vxJS.event.addListener(window,"popstate",function(e){var n,r=t.length;if(e.state)for(;r--&&!(n=t[r].getTabById(e.state)););n&&t[r].gotoTab(n,!1)}),function(i,a){var s=vxJS.dom.getElementsByClassName("vxJS_tabThis",i),l=s.length,c=window.location.hash.slice(1)||"";e=a||{};for(var d=function(e,t){var n=t.getTabByElement(this.nodeName&&"LI"===this.nodeName.toUpperCase()?this:vxJS.dom.getParentElement(this,"li"));!n||n.isDisabled()||t.inactive||(vxJS.event.serve(t,"beforeTabClick"),t.gotoTab(n,!0),vxJS.event.serve(t,"afterTabClick")),vxJS.event.preventDefault(e)};l--;)!function(i){var a,s,l,u,f,h,m,p=vxJS.dom.getElementsByClassName("section",i),v=new o(i);for(u=0,f=p.length;u<f;++u)(a=p[u].getElementsByTagName("h2"))[0]&&(h=a[0].id,(m=new r(v,vxJS.dom.concatText(a[0]),p[u],h)).hide(),a[0].parentNode.removeChild(a[0]),v.tabs.push(m),(h&&h===c||!l&&vxJS.dom.hasClassName(p[u],"default"))&&(l=m));if(f=v.tabs.length){for(l||(l=v.tabs[0]),s="ul".setProp("class","tab").create(),u=0;u<f;++u)(m=v.tabs)[u].nextTab=m[u+1]||null,m[u].prevTab=u-1>=0?m[u-1]:null,s.appendChild(m[u].element);l.show(),v.last=l,v.ulElement=s,v.element="div".setProp("class","vxJS_tabBar").create([e.spacersTop,s,e.spacersBottom]),i.insertBefore(v.element,i.firstChild),vxJS.event.addListener(v,"click",d),t.push(v),n&&l.id&&e.setHash&&window.history.replaceState(l.id,"","#"+l.id)}}(s[l]);return t}}();